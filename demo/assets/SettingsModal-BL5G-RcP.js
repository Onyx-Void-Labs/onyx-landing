const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CFhynXdJ.js","./index-Cik482Pl.css"])))=>i.map(i=>d[i]);
import{c as _,j as r,S as se,r as I,p as L,C as rn,a as nn,u as Ce,b as sn,H as on,i as an,d as cn,e as ln,L as br,f as Pe,g as dn,F as un,U as hn,_ as zt,D as St,I as Ct,h as At,w as fn,k as xn,l as pn,m as mn,T as gn,X as bn}from"./index-CFhynXdJ.js";import{K as yn,A as wn,e as vn,a as jn,C as xt,d as Nn,b as kn,L as Mt,R as En,c as zn,f as Sn}from"./AuthForms-BQLAeH4Y.js";import{openPath as Cn}from"./index-BD1edYoO.js";const An=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Mn=_("circle-check",An);const Tn=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],In=_("code",Tn);const _n=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],Bn=_("cpu",_n);const Rn=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],ye=_("crown",Rn);const Ln=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],ut=_("database",Ln);const Pn=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Dn=_("download",Pn);const Fn=[["path",{d:"M10.65 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v10.1",key:"1a2hbp"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m10 15 1 1",key:"1h4vmv"}],["path",{d:"m11 14-4.586 4.586",key:"maylof"}],["circle",{cx:"5",cy:"20",r:"2",key:"860zyv"}]],Tt=_("file-key",Fn);const Un=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Hn=_("info",Un);const On=[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]],$n=_("keyboard",On);const qn=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Vn=_("log-out",qn);const Kn=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Gn=_("monitor",Kn);const Wn=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],It=_("moon",Wn);const Yn=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Jn=_("palette",Yn);const Xn=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],ve=_("server",Xn);const Qn=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Zn=_("smartphone",Qn);const es=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],ts=_("sun",es);const rs=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],ns=_("terminal",rs);const ss=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],_t=_("toggle-left",ss);const os=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],Bt=_("toggle-right",os);const is=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],as=_("type",is);const cs=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],je=_("user",cs);const ls=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],ds=_("wifi-off",ls);const us=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],yr=_("zap",us);function hs({activeTab:t,setActiveTab:e,user:n}){const s=[{label:"General",items:[{id:"account",label:n?"Cloud & Plan":"Account",icon:je},...n?[{id:"security",label:"Security & Privacy",icon:se}]:[]]},{label:"Look & Feel",items:[{id:"appearance",label:"Appearance",icon:Jn}]},{label:"Workspace",items:[{id:"editor",label:"Editor",icon:In},{id:"shortcuts",label:"Keybinds",icon:yn},{id:"features",label:"Features",icon:yr},{id:"storage",label:"Data",icon:ut}]}],o=[{id:"about",label:"About",icon:Hn}];return r.jsxs("div",{className:"w-64 bg-zinc-900/30 border-r border-white/5 flex flex-col p-2 h-full",children:[r.jsxs("div",{className:"flex items-center gap-3 px-4 mb-6 mt-4",children:[r.jsx("div",{className:"w-8 h-8 bg-purple-500/10 rounded-xl flex items-center justify-center text-purple-400",children:r.jsx(Bn,{size:18})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-zinc-200 tracking-tight",children:"Onyx Config"}),r.jsx("div",{className:"text-[10px] uppercase font-bold text-zinc-600",children:"v0.0.3-alpha"})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto space-y-6 custom-scrollbar px-2",children:s.map((i,a)=>r.jsxs("div",{className:"space-y-1",children:[r.jsx("div",{className:"px-4 text-[10px] uppercase tracking-widest font-bold text-zinc-600 mb-2",children:i.label}),i.items.map(c=>r.jsxs("button",{onClick:()=>e(c.id),className:`w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group active:scale-95 ${t===c.id?"bg-purple-500/10 text-purple-400 shadow-sm":"text-zinc-400 hover:text-zinc-200 hover:bg-white/5"}`,children:[r.jsx(c.icon,{size:16,className:`${t===c.id?"text-purple-400":"opacity-70"} transition-transform group-hover:scale-110`}),r.jsx("span",{children:c.label})]},c.id))]},a))}),r.jsxs("div",{className:"mt-4 pt-4 border-t border-white/5 space-y-2",children:[o.map(i=>r.jsxs("button",{onClick:()=>e(i.id),className:`w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 active:scale-95 ${t===i.id?"bg-purple-500/10 text-purple-400 shadow-sm":"text-zinc-400 hover:text-zinc-200 hover:bg-white/5"}`,children:[r.jsx(i.icon,{size:16,className:t===i.id?"text-purple-400":"opacity-70"}),r.jsx("span",{children:i.label})]},i.id)),r.jsx("div",{className:"px-2 pt-2",children:r.jsxs("div",{className:"p-3 rounded-xl bg-gradient-to-br from-indigo-500/10 to-purple-500/10 border border-white/5",children:[r.jsx("div",{className:"text-xs font-semibold text-zinc-300",children:"Onyx Pro"}),r.jsx("div",{className:"text-[10px] text-zinc-500 mt-0.5",children:"v0.0.3-alpha"})]})})]})]})}function we(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?we=function(e){return typeof e}:we=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(t)}var wr="clover",fs=function(e){return e===3?"v3":e},vr="https://js.stripe.com",xs="".concat(vr,"/").concat(wr,"/stripe.js"),ps=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ms=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var gs=function(e){return ps.test(e)||ms.test(e)},bs=function(){for(var e=document.querySelectorAll('script[src^="'.concat(vr,'"]')),n=0;n<e.length;n++){var s=e[n];if(gs(s.src))return s}return null},Rt=function(e){var n="",s=document.createElement("script");s.src="".concat(xs).concat(n);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(s),s},ys=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.7.0",startTime:n})},ie=null,he=null,fe=null,ws=function(e){return function(n){e(new Error("Failed to load Stripe.js",{cause:n}))}},vs=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},js=function(e){return ie!==null?ie:(ie=new Promise(function(n,s){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var o=bs();if(!(o&&e)){if(!o)o=Rt(e);else if(o&&fe!==null&&he!==null){var i;o.removeEventListener("load",fe),o.removeEventListener("error",he),(i=o.parentNode)===null||i===void 0||i.removeChild(o),o=Rt(e)}}fe=vs(n,s),he=ws(s),o.addEventListener("load",fe),o.addEventListener("error",he)}catch(a){s(a);return}}),ie.catch(function(n){return ie=null,Promise.reject(n)}))},Ns=function(e,n,s){if(e===null)return null;var o=n[0];if(typeof o!="string")throw new Error("Expected publishable key to be of type string, got type ".concat(we(o)," instead."));var i=o.match(/^pk_test/),a=fs(e.version),c=wr;i&&a!==c&&console.warn("Stripe.js@".concat(a," was loaded on the page, but @stripe/stripe-js@").concat("8.7.0"," expected Stripe.js@").concat(c,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var l=e.apply(void 0,n);return ys(l,s),l},ae,jr=!1,Nr=function(){return ae||(ae=js(null).catch(function(e){return ae=null,Promise.reject(e)}),ae)};Promise.resolve().then(function(){return Nr()}).catch(function(t){jr||console.warn(t)});var ks=function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];jr=!0;var o=Date.now();return Nr().then(function(i){return Ns(i,n,o)})};const Es=[{id:"free",name:"Starter",price:"Free",storage:"1GB",features:["Cloud Sync","E2E Encryption","Basic Tools"],color:"text-zinc-400",bg:"bg-zinc-500/10",border:"border-zinc-500/20",glow:"shadow-zinc-500/40",hoverBorder:"hover:border-zinc-500/50",icon:je},{id:"basic",name:"Basic",price:"$1",period:"/mo",storage:"25GB",features:["All Starter Features","Priority Sync","Extended History"],color:"text-emerald-400",bg:"bg-emerald-500/10",border:"border-emerald-500/20",glow:"shadow-emerald-500/40",hoverBorder:"hover:border-emerald-500/50",icon:xt},{id:"pro",name:"Pro",price:"$2",period:"/mo",storage:"50GB",features:["All Basic Features","Advanced Search","24/7 Support"],color:"text-blue-400",bg:"bg-blue-500/10",border:"border-blue-500/20",glow:"shadow-blue-500/40",hoverBorder:"hover:border-blue-500/50",icon:nn},{id:"ultra",name:"Ultra",price:"$3",period:"/mo",storage:"200GB",features:["All Pro Features","AI Assistant","Early Access"],color:"text-purple-400",bg:"bg-purple-500/10",border:"border-purple-500/20",glow:"shadow-purple-500/40",hoverBorder:"hover:border-purple-500/50",icon:ye}];function zs({user:t,onLogout:e,showAuth:n,setShowAuth:s}){const[o,i]=I.useState(null),[a,c]=I.useState(()=>localStorage.getItem("onyx_local_name")||"Local User"),[l,d]=I.useState(()=>localStorage.getItem("onyx_local_avatar")),[h,u]=I.useState(!1),m=f=>{c(f),localStorage.setItem("onyx_local_name",f)},g=f=>{const p=f.target.files?.[0];if(!p)return;if(p.size>1024*1024){alert("Image must be smaller than 1MB for local storage.");return}const v=new FileReader;v.onloadend=()=>{const k=v.result;d(k),localStorage.setItem("onyx_local_avatar",k)},v.readAsDataURL(p)},[w,j]=I.useState(""),[T,S]=I.useState(!1),[C,b]=I.useState(null);I.useEffect(()=>{if(!t)return;(async()=>{const p=sessionStorage.getItem("onyx_mk");if(p){const v=t.name||"Onyx User",k=await Nn(v,p);if(j(k),t.avatar)try{const E=`http://127.0.0.1:8090/api/files/${t.collectionId}/${t.id}/${t.avatar}`,M=await(await fetch(E)).arrayBuffer(),B=await kn(M,p);b(B)}catch(E){console.error("Failed to decrypt avatar:",E)}}else j(t.name||"Locked")})()},[t]);const x=async f=>{i(f);try{const p=await ks("pk_test_51SyQ14E5jY0cQOyp3fco5mV5IZk2O01fbLyMnToNOL3BeBDGf0jIYNV81Z77AhmMKO0jqaTOB7ARJWAsyGR0wKu900onClH10G"),v=await fetch("http://127.0.0.1:8090/api/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:L.authStore.token},body:JSON.stringify({priceId:f,userId:t.id})});if(v.ok){const k=await v.json();p&&await p.redirectToCheckout({sessionId:k.id})}else console.warn("Backend not ready, mocking selection")}catch(p){console.error("Subscription error:",p)}finally{i(null)}},[A,y]=I.useState(!1),N=()=>{t?.id&&(navigator.clipboard.writeText(t.id),y(!0),setTimeout(()=>y(!1),2e3))};return t?r.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[r.jsxs("div",{className:"p-6 bg-zinc-900/50 rounded-3xl flex items-center gap-6 relative overflow-hidden group",children:[r.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-purple-500/5 blur-[100px] rounded-full pointer-events-none group-hover:bg-purple-500/10 transition-all duration-1000"}),r.jsxs("div",{className:"w-20 h-20 bg-gradient-to-br from-zinc-800 to-zinc-900 rounded-2xl flex items-center justify-center border border-white/10 shadow-xl z-10 relative group/avatar cursor-pointer overflow-hidden",children:[C?r.jsx("img",{src:C,alt:"Avatar",className:"w-full h-full object-cover"}):r.jsx(je,{size:32,className:"text-zinc-400"}),r.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover/avatar:opacity-100 transition-opacity flex items-center justify-center",onClick:()=>document.getElementById("avatar-upload")?.click(),children:r.jsx("span",{className:"text-[10px] uppercase font-bold text-white",children:"Upload"})}),r.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",className:"hidden",onChange:async f=>{if(f.target.files?.[0])try{const p=sessionStorage.getItem("onyx_mk");if(!p)return alert("Session Locked.");const v=f.target.files[0],k=await vn(v,p),E=new File([k],"avatar.png",{type:"image/png"}),z=new FormData;z.append("avatar",E);const M=await L.collection("users").update(t.id,z);L.authStore.save(L.authStore.token,M);const B=new FileReader;B.onload=X=>b(X.target?.result),B.readAsDataURL(v)}catch(p){console.error("Avatar upload failed",p)}}})]}),r.jsxs("div",{className:"flex-1 z-10",children:[T?r.jsx("input",{autoFocus:!0,className:"bg-transparent text-2xl font-bold text-white focus:outline-none border-b border-purple-500/50 mb-1 w-full max-w-[200px]",value:w,onChange:f=>j(f.target.value),onBlur:async()=>{if(w)try{const f=sessionStorage.getItem("onyx_mk");if(f){const p=await jn(w,f),v=await L.collection("users").update(t.id,{name:p});L.authStore.save(L.authStore.token,v)}}catch(f){console.error("Name update failed",f)}S(!1)},onKeyDown:f=>f.key==="Enter"&&f.currentTarget.blur()}):r.jsxs("h2",{className:"text-2xl font-bold text-white mb-1 hover:text-purple-400 cursor-pointer transition-colors flex items-center gap-2 group/name",onClick:()=>{S(!0)},children:[w||"Onyx User",r.jsx("span",{className:"opacity-0 group-hover/name:opacity-100 text-[10px] font-normal text-zinc-500 uppercase tracking-wider border border-zinc-700 px-1.5 py-0.5 rounded ml-2",children:"Edit"})]}),r.jsxs("button",{onClick:N,className:"text-sm text-zinc-500 font-mono mb-3 hover:text-purple-400 transition-colors flex items-center gap-2 group/uid cursor-pointer",title:"Click to copy User ID",children:["ID: ",t.id?.slice(0,10),"...",r.jsx(rn,{size:12,className:`opacity-0 group-hover/uid:opacity-100 transition-opacity ${A?"text-emerald-400":""}`}),A&&r.jsx("span",{className:"text-[10px] text-emerald-400 font-bold",children:"Copied!"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("span",{className:"px-2 py-1 bg-emerald-500/10 border border-emerald-500/20 rounded-lg text-[10px] font-bold text-emerald-400 uppercase tracking-wider flex items-center gap-1.5",children:[r.jsx(se,{size:10})," Zero-Knowledge"]}),r.jsx("span",{className:"px-2 py-1 bg-zinc-800 border border-white/5 rounded-lg text-[10px] font-bold text-zinc-500 uppercase tracking-wider",children:"Free Plan"})]})]}),r.jsxs("button",{onClick:e,className:"z-10 px-5 py-2.5 bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/20 rounded-xl text-xs font-bold uppercase tracking-wider transition-all flex items-center gap-2",children:[r.jsx(Vn,{size:16})," Sign Out"]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between text-xs font-medium text-zinc-400 uppercase tracking-wider px-1",children:[r.jsx("span",{children:"Cloud Storage"}),r.jsx("span",{children:"12% Used (120MB / 1GB)"})]}),r.jsx("div",{className:"h-3 w-full bg-zinc-900 rounded-full overflow-hidden border border-white/5",children:r.jsx("div",{className:"h-full w-[12%] bg-gradient-to-r from-purple-600 to-blue-500 rounded-full shadow-[0_0_15px_rgba(168,85,247,0.5)]"})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h3",{className:"text-sm font-bold text-zinc-300 uppercase tracking-wider flex items-center gap-2",children:[r.jsx(ye,{size:16})," Subscription Plan"]}),r.jsx("div",{className:"grid grid-cols-4 gap-4",children:Es.map(f=>r.jsxs("div",{className:`relative p-5 rounded-3xl border flex flex-col gap-4 group transition-all duration-300 hover:-translate-y-2 ${f.bg} ${f.border} ${f.hoverBorder} hover:${f.glow} hover:shadow-2xl`,children:[f.id==="ultra"&&r.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 px-3 py-1 bg-purple-500 text-white text-[9px] font-bold uppercase tracking-widest rounded-full shadow-lg shadow-purple-500/40",children:"Ultimate"}),r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h4",{className:`text-sm font-bold ${f.color} uppercase tracking-wide`,children:f.name}),r.jsxs("div",{className:"flex items-baseline gap-0.5 mt-1",children:[r.jsx("span",{className:"text-2xl font-bold text-white",children:f.price}),f.period&&r.jsx("span",{className:"text-xs text-zinc-500",children:f.period})]})]}),r.jsx(f.icon,{size:18,className:`${f.color} opacity-50 group-hover:opacity-100 transition-opacity`})]}),r.jsxs("div",{className:"text-xs font-bold text-zinc-300 bg-black/20 px-3 py-2 rounded-xl text-center border border-white/5",children:[f.storage," Storage"]}),r.jsx("ul",{className:"space-y-2 flex-1",children:f.features.map((p,v)=>r.jsxs("li",{className:"text-[10px] text-zinc-400 flex items-center gap-2",children:[r.jsx(xt,{size:10,className:f.color}),p]},v))}),r.jsx("button",{disabled:o!==null,onClick:()=>x(f.id),className:`w-full py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest transition-all ${f.id==="free"?"bg-zinc-800 text-zinc-400 border border-white/5 cursor-default":"bg-white text-black hover:scale-[1.02] shadow-lg active:scale-95"}`,children:f.id==="free"?"Current Plan":o===f.id?"Processing...":"Upgrade"})]},f.id))}),r.jsx("div",{className:"flex justify-center pt-2",children:r.jsx("button",{className:"text-[10px] text-zinc-500 hover:text-zinc-300 underline decoration-zinc-800 underline-offset-4 transition-colors",children:"Manage billing and invoices via Stripe"})})]})]}):n?r.jsx("div",{className:"h-full flex flex-col items-center justify-center animate-in fade-in zoom-in-95 duration-500",children:r.jsx("div",{className:"w-full max-w-lg",children:r.jsx(wn,{onCancel:()=>s(!1),onSuccess:()=>{}})})}):r.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Account & Profile"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Manage your local identity."})]})}),r.jsxs("div",{className:"p-6 bg-white/5 rounded-3xl flex items-center gap-6 group transition-all duration-300 relative overflow-hidden backdrop-blur-md hover:scale-[1.02]",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/5 via-blue-500/5 to-transparent pointer-events-none group-hover:opacity-100 transition-opacity duration-500"}),r.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-purple-500/5 blur-[80px] rounded-full pointer-events-none group-hover:bg-purple-500/10 transition-all duration-500"}),r.jsxs("div",{className:"w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg shadow-purple-500/20 relative group/localavatar cursor-pointer overflow-hidden z-10 hover:scale-105 transition-transform duration-300",onClick:()=>document.getElementById("local-avatar-upload")?.click(),children:[l?r.jsx("img",{src:l,alt:"Local Avatar",className:"w-full h-full object-cover"}):r.jsx(je,{size:32,className:"text-white/80 group-hover/localavatar:text-white transition-colors"}),r.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover/localavatar:opacity-100 transition-opacity flex items-center justify-center",children:r.jsx("span",{className:"text-[10px] uppercase font-bold text-white",children:"Upload"})}),r.jsx("input",{id:"local-avatar-upload",type:"file",accept:"image/*",className:"hidden",onChange:g})]}),r.jsxs("div",{className:"flex-1 space-y-2 z-10",children:[r.jsx("div",{className:"flex items-center gap-3",children:h?r.jsx("input",{autoFocus:!0,className:"bg-transparent text-2xl font-bold text-white focus:outline-none border-b border-purple-500/50 mb-1 w-full max-w-[200px]",value:a,onChange:f=>c(f.target.value),onBlur:()=>{m(a),u(!1)},onKeyDown:f=>f.key==="Enter"&&f.currentTarget.blur()}):r.jsxs("h2",{className:"text-2xl font-bold text-white mb-1 hover:text-purple-300 cursor-pointer transition-all duration-300 flex items-center gap-2 group/name hover:scale-105 origin-left",onClick:()=>u(!0),children:[a,r.jsx("span",{className:"opacity-0 group-hover/name:opacity-100 text-[10px] font-normal text-zinc-500 uppercase tracking-wider border border-zinc-700 px-1.5 py-0.5 rounded ml-2",children:"Edit"})]})}),r.jsx("p",{className:"text-sm text-zinc-400 font-medium",children:"Settings are stored locally on this device."})]})]}),r.jsxs("div",{className:"relative rounded-[40px] overflow-hidden transition-all duration-300 group/hero shadow-2xl shadow-black/50 shimmer-trigger hover:scale-[1.02] backface-hidden transform-gpu",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-900/20 via-zinc-900/90 to-black/95 backdrop-blur-xl group-hover/hero:bg-zinc-900/90 transition-colors duration-500"}),r.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-purple-500/5 blur-[150px] rounded-full pointer-events-none group-hover/hero:bg-purple-500/5 transition-all duration-1000 group-hover/hero:translate-x-10 group-hover/hero:-translate-y-10"}),r.jsx("div",{className:"relative z-10 py-11 px-10 text-center space-y-8",children:r.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500 space-y-8 pointer-events-none",children:[r.jsxs("div",{className:"w-24 h-24 bg-gradient-to-tr from-purple-500/10 to-blue-500/10 rounded-3xl flex items-center justify-center mx-auto border border-white/5 relative overflow-hidden group/icon pointer-events-auto hover:bg-purple-500/10 hover:border-purple-500/20 transition-all duration-300",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-purple-500/20 via-transparent to-blue-500/20 opacity-0 group-hover/icon:opacity-100 transition-opacity duration-700"}),r.jsx("div",{className:"absolute inset-0 border border-purple-500/20 rounded-3xl scale-75 opacity-0 group-hover/icon:scale-110 group-hover/icon:opacity-100 transition-all duration-[2500ms] delay-100"}),r.jsx("div",{className:"absolute inset-0 border border-blue-500/20 rounded-3xl scale-50 opacity-0 group-hover/icon:scale-125 group-hover/icon:opacity-100 transition-all duration-[2500ms] delay-200"}),r.jsx(ye,{size:40,className:"text-white z-10 relative"})]}),r.jsxs("div",{className:"max-w-2xl mx-auto space-y-4 pointer-events-auto",children:[r.jsx("h3",{className:"text-3xl font-bold tracking-tight premium-shimmer inline-block",children:"Unlock Your Identity"}),r.jsxs("p",{className:"text-zinc-400 text-sm leading-relaxed font-medium group-hover/hero:text-zinc-300 transition-colors",children:["Securely sync your notes across devices with ",r.jsx("span",{className:"text-emerald-400 font-bold",children:"Zero-Knowledge Encryption"}),"."]})]}),r.jsx("div",{className:"flex justify-center pt-2",children:r.jsxs("button",{onClick:()=>s(!0),className:"pointer-events-auto px-10 py-4 bg-white text-black rounded-full text-sm font-bold shadow-[0_0_20px_rgba(255,255,255,0.1)] flex items-center gap-2 hover:bg-white hover:scale-105 active:scale-95 transition-all duration-300",children:[r.jsx(ye,{size:16})," Begin Journey"]})})]})})]})]})}function Ss(){const{uiFontFamily:t,uiFontSize:e,updateSettings:n}=Ce(),[s,o]=I.useState(!1),i=[{id:"Inter, sans-serif",name:"Inter (Default)"},{id:"Roboto, sans-serif",name:"Roboto"},{id:"System, sans-serif",name:"System UI"},{id:'"Helvetica Neue", Helvetica, Arial, sans-serif',name:"Helvetica Neue"},{id:"Georgia, serif",name:"Georgia"},{id:'"Courier New", monospace',name:"Courier New"}],a=i.find(c=>c.id===t)?.name||"Custom";return r.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Look & Feel"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Customize the aesthetics of your workspace."})]})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h3",{className:"text-sm font-bold text-zinc-300 uppercase tracking-wider flex items-center gap-2",children:[r.jsx(It,{size:16})," Theme"]}),r.jsx("div",{className:"grid grid-cols-3 gap-4",children:["Dark","Light","System"].map(c=>r.jsxs("button",{className:`p-4 rounded-2xl border flex flex-col items-center gap-3 transition-all ${c==="Dark"?"bg-zinc-800 border-purple-500/50 shadow-[0_0_20px_rgba(168,85,247,0.15)]":"bg-zinc-900/40 border-zinc-800 hover:bg-zinc-800 hover:border-zinc-700"}`,children:[r.jsxs("div",{className:`w-full h-24 rounded-xl border flex items-center justify-center ${c==="Dark"?"bg-[#09090b] border-white/5":c==="Light"?"bg-white border-zinc-200":"bg-gradient-to-br from-[#09090b] to-white border-white/10"}`,children:[c==="Dark"&&r.jsx(It,{size:24,className:"text-purple-400"}),c==="Light"&&r.jsx(ts,{size:24,className:"text-orange-400"}),c==="System"&&r.jsx(Gn,{size:24,className:"text-zinc-400"})]}),r.jsx("span",{className:`text-xs font-bold ${c==="Dark"?"text-white":"text-zinc-500"}`,children:c})]},c))})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h3",{className:"text-sm font-bold text-zinc-300 uppercase tracking-wider flex items-center gap-2",children:[r.jsx(as,{size:16})," Typography"]}),r.jsxs("div",{className:"p-6 bg-zinc-900/50 border border-white/5 rounded-3xl space-y-6",children:[r.jsxs("div",{className:"space-y-3 relative",children:[r.jsx("label",{className:"text-xs font-bold text-zinc-500 uppercase tracking-wide",children:"Interface Font"}),r.jsxs("button",{onClick:()=>o(!s),className:"w-full flex items-center justify-between px-4 py-3 bg-black/20 border border-white/5 hover:bg-white/5 rounded-xl transition-all text-sm text-zinc-200",children:[r.jsx("span",{style:{fontFamily:t},children:a}),r.jsx(sn,{size:16,className:`text-zinc-500 transition-transform ${s?"rotate-180":""}`})]}),s&&r.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-[#18181b] border border-white/10 rounded-xl shadow-2xl z-50 overflow-hidden animate-in fade-in zoom-in-95 duration-100 max-h-60 overflow-y-auto custom-scrollbar",children:i.map(c=>r.jsxs("button",{onClick:()=>{n({uiFontFamily:c.id}),o(!1)},className:"w-full flex items-center justify-between px-4 py-3 hover:bg-white/5 text-left text-sm transition-colors",children:[r.jsx("span",{style:{fontFamily:c.id},className:t===c.id?"text-purple-400 font-bold":"text-zinc-300",children:c.name}),t===c.id&&r.jsx(xt,{size:14,className:"text-purple-400"})]},c.id))})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("label",{className:"text-xs font-bold text-zinc-500 uppercase tracking-wide",children:"Interface Scale"}),r.jsxs("span",{className:"text-xs font-mono text-zinc-400",children:[e,"px"]})]}),r.jsx("input",{type:"range",min:"12",max:"20",value:e||14,onChange:c=>n({uiFontSize:parseInt(c.target.value)}),className:"w-full h-1.5 bg-black/40 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-purple-500 hover:[&::-webkit-slider-thumb]:bg-purple-400"})]})]})]})]})}function Cs(){const{editorFontFamily:t,vimMode:e,lineNumbers:n,updateSettings:s}=Ce(),o=[{id:'"JetBrains Mono", monospace',name:"JetBrains Mono"},{id:'"Fira Code", monospace',name:"Fira Code"},{id:"Consolas, monospace",name:"Consolas"}];return r.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Editor Settings"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Fine-tune your writing and coding experience."})]})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h3",{className:"text-sm font-bold text-zinc-300 uppercase tracking-wider flex items-center gap-2",children:[r.jsx(As,{size:16})," Font Configuration"]}),r.jsx("div",{className:"p-6 bg-zinc-900/50 border border-white/5 rounded-3xl space-y-6",children:r.jsx("div",{className:"grid grid-cols-3 gap-3",children:o.map(i=>r.jsx("button",{onClick:()=>s({editorFontFamily:i.id}),className:`px-4 py-3 rounded-xl text-sm border transition-all ${t===i.id?"bg-blue-500/10 border-blue-500/50 text-blue-400 font-bold":"bg-black/20 border-white/5 text-zinc-400 hover:bg-white/5"}`,style:{fontFamily:i.id},children:i.name},i.id))})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h3",{className:"text-sm font-bold text-zinc-300 uppercase tracking-wider flex items-center gap-2",children:[r.jsx(ns,{size:16})," Interface & Behavior"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("button",{onClick:()=>s({lineNumbers:!n}),className:`relative overflow-hidden p-1 rounded-3xl border transition-all duration-300 text-left group ${n?"bg-blue-500/5 border-blue-500/30":"bg-zinc-900/40 border-zinc-800 hover:border-zinc-700"}`,children:[r.jsx("div",{className:"absolute inset-x-0 top-0 h-32 bg-gradient-to-b from-black/50 to-transparent z-10"}),r.jsxs("div",{className:"relative h-32 bg-[#1e1e2e] rounded-t-2xl border-b border-white/5 overflow-hidden flex font-mono text-[10px] leading-relaxed p-4 pt-6 mx-1 mt-1",children:[r.jsxs("div",{className:`flex flex-col text-zinc-600 pr-3 border-r border-white/5 mr-3 transition-all duration-300 ${n?"opacity-100 translate-x-0 w-6":"opacity-0 -translate-x-4 w-0 border-none"}`,children:[r.jsx("span",{children:"1"}),r.jsx("span",{children:"2"}),r.jsx("span",{children:"3"})]}),r.jsxs("div",{className:"text-zinc-400",children:[r.jsxs("div",{className:"text-blue-400",children:["function ",r.jsx("span",{className:"text-yellow-400",children:"add"}),"(a, b) ","{"]}),r.jsx("div",{className:"pl-4",children:"return a + b;"}),r.jsx("div",{children:"}"})]})]}),r.jsx("div",{className:"p-5 relative z-20 bg-gradient-to-t from-zinc-900/90 via-zinc-900/50 to-transparent -mt-10 pt-10",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:`text-sm font-bold transition-colors ${n?"text-blue-400":"text-zinc-300"}`,children:"Line Numbers"}),r.jsx("div",{className:"text-[10px] text-zinc-500 mt-0.5",children:"Show gutter indicators"})]}),n?r.jsx(Bt,{size:28,className:"text-blue-400"}):r.jsx(_t,{size:28,className:"text-zinc-600"})]})})]}),r.jsxs("button",{onClick:()=>s({vimMode:!e}),className:`relative overflow-hidden p-1 rounded-3xl border transition-all duration-300 text-left group ${e?"bg-green-500/5 border-green-500/30":"bg-zinc-900/40 border-zinc-800 hover:border-zinc-700"}`,children:[r.jsxs("div",{className:"relative h-32 bg-[#1e1e2e] rounded-t-2xl border-b border-white/5 overflow-hidden flex flex-col justify-end p-2 mx-1 mt-1",children:[r.jsxs("div",{className:`flex items-center justify-between px-3 py-1 text-[9px] font-mono font-bold transition-all duration-300 ${e?"bg-green-500 text-black translate-y-0":"bg-zinc-800 text-zinc-500 translate-y-8"}`,children:[r.jsxs("div",{className:"flex gap-4",children:[r.jsx("span",{children:"NORMAL"}),r.jsx("span",{children:"main.tsx"})]}),r.jsx("span",{children:"100%"})]}),r.jsx("div",{className:`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 transition-opacity duration-300 ${e?"opacity-0":"opacity-100"}`,children:r.jsx($n,{size:32,className:"text-zinc-700"})})]}),r.jsx("div",{className:"p-5 relative z-20 bg-gradient-to-t from-zinc-900/90 via-zinc-900/50 to-transparent -mt-10 pt-10",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:`text-sm font-bold transition-colors ${e?"text-green-400":"text-zinc-300"}`,children:"Vim Mode"}),r.jsx("div",{className:"text-[10px] text-zinc-500 mt-0.5",children:"Vim keybindings active"})]}),e?r.jsx(Bt,{size:28,className:"text-green-400"}):r.jsx(_t,{size:28,className:"text-zinc-600"})]})})]})]})]})]})}function As({size:t}){return r.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("polyline",{points:"4 7 4 4 20 4 20 7"}),r.jsx("line",{x1:"9",y1:"20",x2:"15",y2:"20"}),r.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"20"})]})}function Ms(){return r.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[r.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Keyboard Shortcuts"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Customize your workflow efficiency."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"p-4 bg-zinc-900/50 border border-white/5 rounded-2xl space-y-3",children:[r.jsx("h3",{className:"text-zinc-400 text-sm font-semibold uppercase tracking-wider mb-2",children:"Editor"}),r.jsx(P,{label:"Bold",keys:["Mod","B"]}),r.jsx(P,{label:"Italic",keys:["Mod","I"]}),r.jsx(P,{label:"Underline",keys:["Mod","U"]}),r.jsx(P,{label:"Inline Code",keys:["Mod","`"]}),r.jsx(P,{label:"Inline Math",keys:["Mod","M"]}),r.jsx(P,{label:"Block Math",keys:["Mod","Shift","M"]}),r.jsx(P,{label:"Find",keys:["Mod","F"]})]}),r.jsxs("div",{className:"p-4 bg-zinc-900/50 border border-white/5 rounded-2xl space-y-3",children:[r.jsx("h3",{className:"text-zinc-400 text-sm font-semibold uppercase tracking-wider mb-2",children:"General"}),r.jsx(P,{label:"Quick Search",keys:["Mod","P"]}),r.jsx(P,{label:"Settings",keys:["Mod",","]}),r.jsx(P,{label:"Toggle Sidebar",keys:["Mod","\\"]}),r.jsx(P,{label:"New Note",keys:["Mod","N"]}),r.jsx(P,{label:"Close Tab",keys:["Mod","W"]}),r.jsx(P,{label:"Next Tab",keys:["Ctrl","Tab"]}),r.jsx(P,{label:"Prev Tab",keys:["Ctrl","Shift","Tab"]})]})]})]})}function P({label:t,keys:e}){return r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-zinc-300 text-sm",children:t}),r.jsx("div",{className:"flex items-center gap-1",children:e.map((n,s)=>r.jsx("kbd",{className:"px-2 py-1 bg-zinc-800 rounded-md text-[10px] text-zinc-400 font-mono border border-white/5 min-w-[24px] text-center",children:n==="Mod"?"Ctrl":n},s))})]})}function Ts(){return r.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[r.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"About Onyx"}),r.jsxs("div",{className:"p-8 bg-zinc-900/50 border border-white/5 rounded-3xl flex flex-col items-center justify-center text-center space-y-6",children:[r.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-3xl flex items-center justify-center shadow-2xl shadow-purple-500/20",children:r.jsx("span",{className:"text-4xl font-bold text-white",children:"O"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-2xl font-bold text-white",children:"Onyx"}),r.jsx("p",{className:"text-zinc-500 font-mono text-xs mt-1",children:"Version 0.0.3-alpha"})]}),r.jsxs("p",{className:"text-sm text-zinc-400 max-w-md leading-relaxed",children:["Designed for speed, security, and simplicity. ",r.jsx("br",{}),"Onyx is built with a Zero-Knowledge architecture to ensure your thoughts remain yours alone."]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{className:"px-3 py-1 bg-white/5 rounded-full text-[10px] text-zinc-500 border border-white/5",children:"React"}),r.jsx("span",{className:"px-3 py-1 bg-white/5 rounded-full text-[10px] text-zinc-500 border border-white/5",children:"Tauri"}),r.jsx("span",{className:"px-3 py-1 bg-white/5 rounded-full text-[10px] text-zinc-500 border border-white/5",children:"Rust"}),r.jsx("span",{className:"px-3 py-1 bg-white/5 rounded-full text-[10px] text-zinc-500 border border-white/5",children:"PocketBase"})]}),r.jsxs("div",{className:"pt-8 text-xs text-zinc-600 flex items-center gap-1.5",children:["Made with ",r.jsx(on,{size:12,className:"text-red-500/50 fill-red-500/50"})," by Omar"]})]})]})}function Is(){return r.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[r.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Experimental Features"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Test drive upcoming capabilities."}),r.jsxs("div",{className:"p-8 bg-zinc-900/50 border border-white/5 rounded-3xl flex flex-col items-center justify-center text-center space-y-4",children:[r.jsx("div",{className:"w-16 h-16 bg-purple-500/10 rounded-2xl flex items-center justify-center text-purple-400",children:r.jsx(yr,{size:32})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-zinc-300",children:"Lab Closed"}),r.jsx("p",{className:"text-sm text-zinc-500 max-w-sm mt-2",children:"There are no experimental features available for testing at the moment. Check back later!"})]})]})]})}async function De(t={}){return typeof t=="object"&&Object.freeze(t),await an("plugin:dialog|open",{options:t})}function _s(){const{files:t,createFile:e}=cn(),{storageProvider:n,updateSettings:s,mirrorEnabled:o,mirrorPath:i,mirrorDeleteToBin:a}=Ce(),[c,l]=I.useState("Loading...");I.useEffect(()=>{ln().then(x=>l(x))},[]);const[d,h]=I.useState(!1),u=x=>{x==="local-only"?zt(async()=>{const{pb:A}=await import("./index-CFhynXdJ.js").then(y=>y.a7);return{pb:A}},__vite__mapDeps([0,1]),import.meta.url).then(({pb:A})=>{A.authStore.isValid?h(!0):m()}):s(x==="onyx-cloud"?{storageProvider:"onyx-cloud",offlineMode:!1,cloudEnabled:!0}:{storageProvider:x})},m=()=>{zt(async()=>{const{pb:x}=await import("./index-CFhynXdJ.js").then(A=>A.a7);return{pb:x}},__vite__mapDeps([0,1]),import.meta.url).then(({pb:x})=>{x.authStore.clear()}),s({storageProvider:"local-only",offlineMode:!0,cloudEnabled:!1}),h(!1)},g=async()=>{try{const x=await De({directory:!0,multiple:!1,title:"Select Mirror Folder"});x&&typeof x=="string"&&s({mirrorPath:x})}catch(x){console.error("Failed to open dialog:",x)}},[w,j]=I.useState(!1),[T,S]=I.useState(!1),C=async()=>{try{const x=await De({directory:!0,multiple:!1,title:"Select Export Folder"});if(!x||typeof x!="string")return;j(!0);let A=0;for(const y of t){const N=new St,f=new Ct(`onyx-note-${y.id}`,N);await new Promise(z=>{f.once("synced",()=>{z()})});const p=N.getText("codemirror").toString();let k=`${y.title.replace(/[^a-z0-9\u00a0-\uffff\-_\. ]/gi,"_").trim()||"Untitled"}.md`,E=await At(x,k);await fn(E,p),f.destroy(),N.destroy(),A++}console.log(`Exported ${A} notes.`),j(!1)}catch(x){console.error("Export failed:",x),j(!1)}},b=async()=>{try{const x=await De({directory:!0,multiple:!1,title:"Select Import Folder"});if(!x||typeof x!="string")return;S(!0);const A=await xn(x);let y=0;for(const N of A)if(N.isFile&&N.name.endsWith(".md")){const f=await At(x,N.name),p=await pn(f),v=N.name.replace(/\.md$/i,""),k=e(v),E=new St,z=new Ct(`onyx-note-${k}`,E);await new Promise(M=>{z.once("synced",()=>M())}),E.transact(()=>{E.getText("codemirror").insert(0,p),E.getMap("meta").set("title",v)}),await new Promise(M=>setTimeout(M,50)),z.destroy(),E.destroy(),y++}S(!1)}catch(x){console.error("Import failed:",x),S(!1)}};return r.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500 pb-10 relative",children:[d&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"w-full max-w-md bg-zinc-900 border border-zinc-800 rounded-xl shadow-2xl p-6 space-y-6 animate-in zoom-in-95 duration-200",children:[r.jsxs("div",{className:"flex items-center gap-3 text-red-500",children:[r.jsx("div",{className:"p-3 bg-red-500/10 rounded-full",children:r.jsx(se,{size:24})}),r.jsx("h3",{className:"text-lg font-bold text-zinc-100",children:"Switch to Local Only?"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("p",{className:"text-zinc-400 text-sm leading-relaxed",children:["You are currently signed in. Switching to ",r.jsx("span",{className:"text-zinc-200 font-medium",children:"Local Only"})," mode will:"]}),r.jsxs("ul",{className:"space-y-2 text-sm text-zinc-400",children:[r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"text-red-500 mt-0.5",children:"•"}),r.jsx("span",{children:"Sign you out of your Onyx Cloud account"})]}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"text-red-500 mt-0.5",children:"•"}),r.jsx("span",{children:"Disable all cloud sync features"})]}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"text-red-500 mt-0.5",children:"•"}),r.jsx("span",{children:"Make Onyx operate 100% offline"})]})]}),r.jsx("p",{className:"text-red-400/80 text-xs italic bg-red-500/5 p-3 rounded-lg border border-red-500/10",children:"Note: Make sure you have your Master Key or Password saved safely. You will need them to sign back in."})]}),r.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[r.jsx("button",{onClick:()=>h(!1),className:"flex-1 py-2.5 px-4 rounded-lg bg-zinc-800 hover:bg-zinc-700 text-zinc-300 text-sm font-medium transition-colors",children:"Cancel"}),r.jsx("button",{onClick:m,className:"flex-1 py-2.5 px-4 rounded-lg bg-red-600 hover:bg-red-500 text-white text-sm font-bold shadow-lg shadow-red-900/20 transition-all",children:"Confirm Switch"})]})]})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Storage & Privacy"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Choose where your data lives and how it's protected."})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"relative p-5 rounded-2xl bg-zinc-900/40 border border-emerald-500/20 overflow-hidden group cursor-default transition-all duration-500 hover:bg-zinc-900/60 hover:border-emerald-500/30",children:[r.jsx("div",{className:"absolute inset-0 bg-emerald-500/10 blur-xl opacity-100"}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(br,{size:18,className:"text-emerald-400"}),r.jsx("h4",{className:"text-sm font-bold text-emerald-100/90",children:"AES-256"})]}),r.jsx("p",{className:"text-[11px] text-zinc-500 group-hover:text-zinc-400 leading-relaxed font-medium transition-colors",children:"Military-grade encryption for your notes at rest. Your keys, your data."})]})]}),r.jsxs("div",{className:"relative p-5 rounded-2xl bg-zinc-900/40 border border-blue-500/20 overflow-hidden group cursor-default transition-all duration-500 hover:bg-zinc-900/60 hover:border-blue-500/30",children:[r.jsx("div",{className:"absolute inset-0 bg-blue-500/10 blur-xl opacity-100"}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(Pe,{size:18,className:"text-blue-400"}),r.jsx("h4",{className:"text-sm font-bold text-blue-100/90",children:"Local-First"})]}),r.jsx("p",{className:"text-[11px] text-zinc-500 group-hover:text-zinc-400 leading-relaxed font-medium transition-colors",children:"Works 100% offline. We sync only when you're ready and online."})]})]}),r.jsxs("div",{className:"relative p-5 rounded-2xl bg-zinc-900/40 border border-purple-500/20 overflow-hidden group cursor-default transition-all duration-500 hover:bg-zinc-900/60 hover:border-purple-500/30",children:[r.jsx("div",{className:"absolute inset-0 bg-purple-500/10 blur-xl opacity-100"}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(se,{size:18,className:"text-purple-400"}),r.jsx("h4",{className:"text-sm font-bold text-purple-100/90",children:"Zero-Knowledge"})]}),r.jsx("p",{className:"text-[11px] text-zinc-500 group-hover:text-zinc-400 leading-relaxed font-medium transition-colors",children:"In Local Mode, no telemetry or data ever leaves your machine."})]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h3",{className:"text-sm font-bold text-zinc-400 uppercase tracking-widest flex items-center gap-2",children:[r.jsx(ut,{size:14})," Primary Storage Provider"]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("button",{onClick:()=>u("onyx-cloud"),className:`relative p-5 rounded-2xl border text-left flex flex-col gap-3 transition-all duration-300 group ${n==="onyx-cloud"?"bg-purple-500/10 border-purple-500/50 shadow-lg shadow-purple-500/20":"bg-zinc-900/30 border-white/5 hover:border-purple-500/30 hover:bg-zinc-900/50"}`,children:[r.jsx("div",{className:`p-3 rounded-xl w-fit transition-colors ${n==="onyx-cloud"?"bg-purple-500 text-white":"bg-zinc-800 text-zinc-400 group-hover:text-purple-400"}`,children:r.jsx(dn,{size:24})}),r.jsxs("div",{children:[r.jsx("div",{className:`font-bold text-base mb-1 ${n==="onyx-cloud"?"text-white":"text-zinc-300"}`,children:"Onyx Cloud"}),r.jsx("p",{className:"text-xs text-zinc-500 leading-relaxed",children:"Encrypted sync across devices with AI features and backups."})]}),n==="onyx-cloud"&&r.jsx("div",{className:"absolute top-4 right-4 text-purple-400 animate-pulse",children:r.jsx("div",{className:"w-2 h-2 rounded-full bg-current"})})]}),r.jsxs("button",{onClick:()=>u("local-only"),className:`relative p-5 rounded-2xl border text-left flex flex-col gap-3 transition-all duration-300 group ${n==="local-only"?"bg-emerald-500/10 border-emerald-500/50 shadow-lg shadow-emerald-500/20":"bg-zinc-900/30 border-white/5 hover:border-emerald-500/30 hover:bg-zinc-900/50"}`,children:[r.jsx("div",{className:`p-3 rounded-xl w-fit transition-colors ${n==="local-only"?"bg-emerald-500 text-white":"bg-zinc-800 text-zinc-400 group-hover:text-emerald-400"}`,children:r.jsx(Pe,{size:24})}),r.jsxs("div",{children:[r.jsx("div",{className:`font-bold text-base mb-1 ${n==="local-only"?"text-white":"text-zinc-300"}`,children:"Local Only"}),r.jsx("p",{className:"text-xs text-zinc-500 leading-relaxed",children:"Data never leaves this device. Sync and online features disabled."})]}),n==="local-only"&&r.jsx("div",{className:"absolute top-4 right-4 text-emerald-400",children:r.jsx(ds,{size:16})})]}),r.jsxs("button",{onClick:()=>u("s3"),className:`relative p-5 rounded-2xl border text-left flex flex-col gap-3 transition-all duration-300 group ${n==="s3"?"bg-zinc-200/5 border-white/20 shadow-lg":"bg-zinc-900/30 border-white/5 hover:border-white/10 hover:bg-zinc-900/50"}`,children:[r.jsx("div",{className:`p-3 rounded-xl w-fit transition-colors ${n==="s3"?"bg-white text-black":"bg-zinc-800 text-zinc-500 group-hover:text-zinc-300"}`,children:r.jsx(ve,{size:24})}),r.jsxs("div",{children:[r.jsx("div",{className:`font-bold text-base mb-1 ${n==="s3"?"text-white":"text-zinc-500"}`,children:"Self-Hosted"}),r.jsx("p",{className:"text-xs text-zinc-500 leading-relaxed",children:"Connect to your own VPS or compatible storage (S3/MinIO)."})]}),n==="s3"&&r.jsx("div",{className:"absolute top-4 right-4 text-white",children:r.jsx("div",{className:"w-2 h-2 rounded-full bg-current shadow-[0_0_10px_white]"})})]})]})]}),n==="s3"&&r.jsxs("div",{className:"p-6 rounded-2xl border border-white/10 bg-zinc-900/40 space-y-4 animate-in fade-in slide-in-from-top-2",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg text-purple-400",children:r.jsx(ve,{size:18})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-white",children:"Server Configuration"}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Enter the URL of your self-hosted instance."})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-[10px] font-bold text-zinc-500 uppercase tracking-wider ml-1",children:"Server URL"}),r.jsx("input",{type:"text",placeholder:"https://api.your-domain.com",className:"w-full bg-zinc-950/50 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:border-purple-500/50 focus:outline-none transition-colors font-mono"})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-[10px] font-bold text-zinc-500 uppercase tracking-wider ml-1",children:"Live Endpoint (Optional)"}),r.jsx("input",{type:"text",placeholder:"wss://api.your-domain.com/realtime",className:"w-full bg-zinc-950/50 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:border-purple-500/50 focus:outline-none transition-colors font-mono"})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx("a",{href:"https://docs.onyx.app/self-hosting",target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-purple-400 hover:text-purple-300 font-bold flex items-center gap-1 transition-colors",children:"Read the Self-Hosting Guide →"})})]}),r.jsxs("div",{className:`p-6 rounded-2xl border transition-all duration-300 ${o?"border-amber-500/20 bg-amber-500/5":"border-white/5 bg-zinc-900/40"}`,children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-2 rounded-lg transition-colors ${o?"bg-amber-500/20 text-amber-400":"bg-zinc-800 text-zinc-400"}`,children:r.jsx(Pe,{size:18})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-white",children:"Local File Mirror"}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Save a copy of your notes as Markdown files on your disk."})]})]}),r.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[r.jsx("input",{type:"checkbox",className:"sr-only peer",checked:o,onChange:x=>s({mirrorEnabled:x.target.checked})}),r.jsx("div",{className:"w-11 h-6 bg-zinc-800 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-amber-500"})]})]}),o&&r.jsxs("div",{className:"mt-4 space-y-4 animate-in fade-in slide-in-from-top-1",children:[r.jsxs("div",{className:"p-3 bg-amber-500/10 border border-amber-500/20 rounded-xl flex gap-3 items-start",children:[r.jsx("div",{className:"mt-0.5 min-w-[16px] text-amber-500",children:r.jsx(se,{size:16})}),r.jsxs("p",{className:"text-xs text-amber-200/80 leading-relaxed",children:[r.jsx("strong",{className:"text-amber-200",children:"Warning:"})," Mirrored files are ",r.jsx("strong",{children:"NOT encrypted"}),". Anyone with access to your computer can read them."]})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-[10px] font-bold text-zinc-500 uppercase tracking-wider ml-1",children:"Mirror Location"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("div",{className:"flex-1 bg-zinc-950/50 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-zinc-400 font-mono truncate cursor-text select-all",title:i||"~/Documents/Onyx Notes",children:i||"~/Documents/Onyx Notes"}),r.jsx("button",{onClick:g,className:"px-4 bg-zinc-800 hover:bg-zinc-700 text-white rounded-xl text-xs font-bold transition-colors border border-white/5",children:"Change"})]})]}),r.jsx("div",{className:"flex justify-end pt-2",children:r.jsxs("a",{href:"https://docs.onyx.app/local-sync",target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-amber-500/60 hover:text-amber-400 font-bold flex items-center gap-1 transition-colors group",children:["How to sync with Syncthing, Git, or iCloud ",r.jsx("span",{className:"group-hover:translate-x-0.5 transition-transform",children:"→"})]})}),r.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-amber-500/10",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-xs font-semibold text-zinc-300",children:"Delete to Recycle Bin"}),r.jsx("p",{className:"text-[10px] text-zinc-500",children:"When deleting notes, move mirror file to Bin instead of permanent delete."})]}),r.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[r.jsx("input",{type:"checkbox",className:"sr-only peer",checked:a,onChange:x=>s({mirrorDeleteToBin:x.target.checked})}),r.jsx("div",{className:"w-11 h-6 bg-zinc-800 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-amber-500"})]})]})]})]}),r.jsxs("div",{className:"p-6 bg-zinc-900/30 border border-white/5 rounded-2xl space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-zinc-300",children:"Internal Database"}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"The location of your encrypted Onyx database."})]}),r.jsx("div",{className:"p-2 bg-zinc-800/50 rounded-lg text-zinc-500",children:r.jsx(ut,{size:16})})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("div",{className:"flex-1 bg-zinc-950/30 border border-white/5 rounded-xl px-4 py-2.5 text-xs text-zinc-500 font-mono truncate select-all",children:c||"Resolving paths..."}),r.jsx("button",{onClick:()=>Cn(c),className:"px-3 bg-zinc-800 hover:bg-zinc-700 text-zinc-300 rounded-xl",children:r.jsx(un,{size:14})})]})]}),r.jsxs("div",{className:"p-6 bg-zinc-900/30 border border-white/5 rounded-2xl flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-zinc-300",children:"Export / Import Data"}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Create portable backups/archives of your notes."})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:b,disabled:T,className:"flex items-center gap-2 px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-zinc-300 text-xs font-bold rounded-lg transition-colors border border-white/5 disabled:opacity-50",children:[T?r.jsx(Mt,{size:12,className:"animate-spin"}):r.jsx(hn,{size:12}),"Import Folder"]}),r.jsxs("button",{onClick:C,disabled:w,className:"flex items-center gap-2 px-4 py-2 bg-white text-black hover:bg-zinc-200 text-xs font-bold rounded-lg transition-colors shadow-lg disabled:opacity-50",children:[w?r.jsx(Mt,{size:12,className:"animate-spin"}):r.jsx(Dn,{size:12}),"Export All"]})]})]})]})}var D=class extends Error{constructor(t,e){super(t,e),this.name="OTPError"}},kr=class extends D{constructor(e){super(e),this.name="SecretError"}},Bs=class extends kr{constructor(e,n){super(`Secret must be at least ${e} bytes (${e*8} bits), got ${n} bytes`),this.name="SecretTooShortError"}},Rs=class extends kr{constructor(e,n){super(`Secret must not exceed ${e} bytes, got ${n} bytes`),this.name="SecretTooLongError"}},pt=class extends D{constructor(e){super(e),this.name="CounterError"}},Ls=class extends pt{constructor(){super("Counter must be non-negative"),this.name="CounterNegativeError"}},Lt=class extends pt{constructor(){super("Counter exceeds maximum safe integer value"),this.name="CounterOverflowError"}},Ps=class extends pt{constructor(){super("Counter must be a finite integer"),this.name="CounterNotIntegerError"}},Er=class extends D{constructor(e){super(e),this.name="TimeError"}},Ds=class extends Er{constructor(){super("Time must be non-negative"),this.name="TimeNegativeError"}},Fs=class extends Er{constructor(){super("Time must be a finite number"),this.name="TimeNotFiniteError"}},zr=class extends D{constructor(t){super(t),this.name="PeriodError"}},Us=class extends zr{constructor(e){super(`Period must be at least ${e} second(s)`),this.name="PeriodTooSmallError"}},Hs=class extends zr{constructor(e){super(`Period must not exceed ${e} seconds`),this.name="PeriodTooLargeError"}},Sr=class extends D{constructor(e){super(e),this.name="TokenError"}},Os=class extends Sr{constructor(e,n){super(`Token must be ${e} digits, got ${n}`),this.name="TokenLengthError"}},$s=class extends Sr{constructor(){super("Token must contain only digits"),this.name="TokenFormatError"}},Cr=class extends D{constructor(t,e){super(t,e),this.name="CryptoError"}},xe=class extends Cr{constructor(e,n){super(`HMAC computation failed: ${e}`,n),this.name="HMACError"}},qs=class extends Cr{constructor(e,n){super(`Random byte generation failed: ${e}`,n),this.name="RandomBytesError"}},mt=class extends D{constructor(t){super(t),this.name="CounterToleranceError"}},Vs=class extends mt{constructor(e,n){super(`Counter tolerance validation failed: total checks (${n}) exceeds MAX_WINDOW (${e})`),this.name="CounterToleranceTooLargeError"}},Ks=class extends mt{constructor(){super("Counter tolerance cannot contain negative values"),this.name="CounterToleranceNegativeError"}},gt=class extends D{constructor(t){super(t),this.name="EpochToleranceError"}},Gs=class extends gt{constructor(){super("Epoch tolerance cannot contain negative values"),this.name="EpochToleranceNegativeError"}},Ws=class extends gt{constructor(t,e){super(`Epoch tolerance must not exceed ${t} seconds, got ${e}. Large tolerances can cause performance issues.`),this.name="EpochToleranceTooLargeError"}},Ar=class extends D{constructor(e){super(e),this.name="PluginError"}},Ys=class extends Ar{constructor(){super("Crypto plugin is required."),this.name="CryptoPluginMissingError"}},Js=class extends Ar{constructor(){super("Base32 plugin is required."),this.name="Base32PluginMissingError"}},ht=class extends D{constructor(t){super(t),this.name="ConfigurationError"}},Xs=class extends ht{constructor(){super("Secret is required. Use generateSecret() to create one, or provide via { secret: 'YOUR_BASE32_SECRET' }"),this.name="SecretMissingError"}},bt=class extends D{constructor(t){super(t),this.name="AfterTimeStepError"}},Qs=class extends bt{constructor(){super("afterTimeStep must be >= 0"),this.name="AfterTimeStepNegativeError"}},Zs=class extends bt{constructor(){super("Invalid afterTimeStep: non-integer value"),this.name="AfterTimeStepNotIntegerError"}},eo=class extends bt{constructor(){super("Invalid afterTimeStep: cannot be greater than current time step plus window"),this.name="AfterTimeStepRangeExceededError"}},to=new TextEncoder;new TextDecoder;var ro=16,no=64,so=20,oo=1,io=3600,ao=30,co=Number.MAX_SAFE_INTEGER,lo=99,uo=Symbol("otplib.guardrails.override"),oe=Object.freeze({MIN_SECRET_BYTES:ro,MAX_SECRET_BYTES:no,MIN_PERIOD:oo,MAX_PERIOD:io,MAX_COUNTER:co,MAX_WINDOW:lo,[uo]:!1});function Ae(t){return oe}function Me(t,e=oe){if(t.length<e.MIN_SECRET_BYTES)throw new Bs(e.MIN_SECRET_BYTES,t.length);if(t.length>e.MAX_SECRET_BYTES)throw new Rs(e.MAX_SECRET_BYTES,t.length)}function Mr(t,e=oe){if(typeof t=="number"){if(!Number.isFinite(t)||!Number.isInteger(t))throw new Ps;if(!Number.isSafeInteger(t))throw new Lt}let n=typeof t=="bigint"?t:BigInt(t);if(n<0n)throw new Ls;if(n>BigInt(e.MAX_COUNTER))throw new Lt}function Tr(t){if(!Number.isFinite(t))throw new Fs;if(t<0)throw new Ds}function Ir(t,e=oe){if(!Number.isInteger(t)||t<e.MIN_PERIOD)throw new Us(e.MIN_PERIOD);if(t>e.MAX_PERIOD)throw new Hs(e.MAX_PERIOD)}function _r(t,e){if(t.length!==e)throw new Os(e,t.length);if(!/^\d+$/.test(t))throw new $s}function ho(t,e=oe){let[n,s]=Br(t);if(!Number.isSafeInteger(n)||!Number.isSafeInteger(s))throw new mt("Counter tolerance values must be safe integers");if(n<0||s<0)throw new Ks;let o=n+s+1;if(o>e.MAX_WINDOW)throw new Vs(e.MAX_WINDOW,o)}function fo(t,e=ao,n=oe){let[s,o]=Array.isArray(t)?t:[t,t];if(!Number.isSafeInteger(s)||!Number.isSafeInteger(o))throw new gt("Epoch tolerance values must be safe integers");if(s<0||o<0)throw new Gs;let i=(n.MAX_WINDOW-1)*e,a=s+o;if(a>i)throw new Ws(i,a)}function xo(t){let e=typeof t=="bigint"?t:BigInt(t),n=new ArrayBuffer(8);return new DataView(n).setBigUint64(0,e,!1),new Uint8Array(n)}function po(t){let e=t[t.length-1]&15;return(t[e]&127)<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function mo(t,e){let n=10**e;return(t%n).toString().padStart(e,"0")}function go(t,e){return t.length===e.length}function bo(t,e){let n=Pt(t),s=Pt(e);if(!go(n,s))return!1;let o=0;for(let i=0;i<n.length;i++)o|=n[i]^s[i];return o===0}function Pt(t){return typeof t=="string"?to.encode(t):t}function Te(t,e){return typeof t=="string"?(Rr(e),e.decode(t)):t}function yo(t){let{crypto:e,base32:n,length:s=so}=t;de(e),Rr(n);let o=e.randomBytes(s);return n.encode(o,{padding:!1})}function Br(t=0){return Array.isArray(t)?t:[0,t]}function wo(t=0){return Array.isArray(t)?t:[t,t]}function de(t){if(!t)throw new Ys}function Rr(t){if(!t)throw new Js}function Ie(t){if(!t)throw new Xs}var vo=class{constructor(t){this.crypto=t}get plugin(){return this.crypto}async hmac(t,e,n){try{let s=this.crypto.hmac(t,e,n);return s instanceof Promise?await s:s}catch(s){let o=s instanceof Error?s.message:String(s);throw new xe(o,{cause:s})}}hmacSync(t,e,n){try{let s=this.crypto.hmac(t,e,n);if(s instanceof Promise)throw new xe("Crypto plugin does not support synchronous HMAC operations");return s}catch(s){if(s instanceof xe)throw s;let o=s instanceof Error?s.message:String(s);throw new xe(o,{cause:s})}}randomBytes(t){try{return this.crypto.randomBytes(t)}catch(e){let n=e instanceof Error?e.message:String(e);throw new qs(n,{cause:e})}}};function jo(t){return new vo(t)}function Lr(t){let{type:e,label:n,params:s}=t,o=n.split(":").map(c=>encodeURIComponent(c)).join(":"),i=`otpauth://${e}/${o}?`,a=[];return s.secret&&a.push(`secret=${encodeURIComponent(s.secret)}`),s.issuer&&a.push(`issuer=${encodeURIComponent(s.issuer)}`),s.algorithm&&s.algorithm!=="sha1"&&a.push(`algorithm=${s.algorithm.toUpperCase()}`),s.digits&&s.digits!==6&&a.push(`digits=${s.digits}`),e==="hotp"&&s.counter!==void 0&&a.push(`counter=${s.counter}`),e==="totp"&&s.period!==void 0&&s.period!==30&&a.push(`period=${s.period}`),i+=a.join("&"),i}function No(t){let{issuer:e,label:n,secret:s,algorithm:o="sha1",digits:i=6,period:a=30}=t,c=e?`${e}:${n}`:n;return Lr({type:"totp",label:c,params:{secret:s,issuer:e,algorithm:o,digits:i,period:a}})}function ko(t){let{issuer:e,label:n,secret:s,counter:o=0,algorithm:i="sha1",digits:a=6}=t,c=e?`${e}:${n}`:n;return Lr({type:"hotp",label:c,params:{secret:s,issuer:e,algorithm:i,digits:a,counter:o}})}function Eo(t){let{secret:e,counter:n,algorithm:s="sha1",digits:o=6,crypto:i,base32:a,guardrails:c,hooks:l}=t;Ie(e),de(i);let d=Te(e,a);Me(d,c),Mr(n,c);let h=jo(i),u=xo(n);return{ctx:h,algorithm:s,digits:o,secretBytes:d,counterBytes:u,hooks:l}}async function Pr(t){let{ctx:e,algorithm:n,digits:s,secretBytes:o,counterBytes:i,hooks:a}=Eo(t),c=await e.hmac(n,o,i),l=a?.truncateDigest?a.truncateDigest(c):po(c);return a?.encodeToken?a.encodeToken(l,s):mo(l,s)}function zo(t){let{secret:e,counter:n,token:s,algorithm:o="sha1",digits:i=6,crypto:a,base32:c,counterTolerance:l=0,guardrails:d=Ae(),hooks:h}=t;Ie(e),de(a);let u=Te(e,c);Me(u,d),Mr(n,d),h?.validateToken?h.validateToken(s,i):_r(s,i),ho(l,d);let m=typeof n=="bigint"?Number(n):n,[g,w]=Br(l),j=g+w+1;return{token:s,counterNum:m,past:g,future:w,totalChecks:j,crypto:a,getGenerateOptions:T=>({secret:u,counter:T,algorithm:o,digits:i,crypto:a,guardrails:d,hooks:h})}}async function So(t){let{token:e,counterNum:n,past:s,totalChecks:o,crypto:i,getGenerateOptions:a}=zo(t),c=Math.max(0,s-n);for(let l=c;l<o;l++){let d=l-s,h=n+d,u=await Pr(a(h));if(i.constantTimeEqual(u,e))return{valid:!0,delta:d|0}}return{valid:!1}}function Co(t){let{secret:e,epoch:n=Math.floor(Date.now()/1e3),t0:s=0,period:o=30,algorithm:i="sha1",digits:a=6,crypto:c,base32:l,guardrails:d=Ae(),hooks:h}=t;Ie(e),de(c);let u=Te(e,l);Me(u,d),Tr(n),Ir(o,d);let m=Math.floor((n-s)/o);return{secret:u,counter:m,algorithm:i,digits:a,crypto:c,guardrails:d,hooks:h}}async function Ao(t){let e=Co(t);return Pr(e)}function Mo(t,e){if(t!==void 0){if(t<0)throw new Qs;if(!Number.isSafeInteger(t))throw new Zs;if(t>e)throw new eo}}function To(t,e){return e!==void 0&&t<=e}function Io(t){let{secret:e,token:n,epoch:s=Math.floor(Date.now()/1e3),t0:o=0,period:i=30,algorithm:a="sha1",digits:c=6,crypto:l,base32:d,epochTolerance:h=0,afterTimeStep:u,guardrails:m=Ae(),hooks:g}=t;Ie(e),de(l);let w=Te(e,d);Me(w,m),Tr(s),Ir(i,m),g?.validateToken?g.validateToken(n,c):_r(n,c),fo(h,i,m);let j=Math.floor((s-o)/i),[T,S]=wo(h),C=Math.max(0,Math.floor((s-T-o)/i)),b=Math.floor((s+S-o)/i);return Mo(u,b),{token:n,crypto:l,minCounter:C,maxCounter:b,currentCounter:j,t0:o,period:i,afterTimeStep:u,getGenerateOptions:x=>({secret:w,epoch:x*i+o,t0:o,period:i,algorithm:a,digits:c,crypto:l,guardrails:m,hooks:g})}}async function _o(t){let{token:e,crypto:n,minCounter:s,maxCounter:o,currentCounter:i,t0:a,period:c,afterTimeStep:l,getGenerateOptions:d}=Io(t);for(let h=s;h<=o;h++){if(To(h,l))continue;let u=await Ao(d(h));if(n.constantTimeEqual(u,e))return{valid:!0,delta:h-i,epoch:h*c+a,timeStep:h}}return{valid:!1}}function Bo(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Dr(t,e){return Array.isArray(e)?e.length===0?!0:t?e.every(n=>typeof n=="string"):e.every(n=>Number.isSafeInteger(n)):!1}function Ne(t,e){if(typeof e!="string")throw new Error(`${t}: string expected`);return!0}function yt(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function ft(t){if(!Array.isArray(t))throw new Error("array expected")}function ke(t,e){if(!Dr(!0,e))throw new Error(`${t}: array of strings expected`)}function Ro(t,e){if(!Dr(!1,e))throw new Error(`${t}: array of numbers expected`)}function Lo(...t){const e=i=>i,n=(i,a)=>c=>i(a(c)),s=t.map(i=>i.encode).reduceRight(n,e),o=t.map(i=>i.decode).reduce(n,e);return{encode:s,decode:o}}function Po(t){const e=typeof t=="string"?t.split(""):t,n=e.length;ke("alphabet",e);const s=new Map(e.map((o,i)=>[o,i]));return{encode:o=>(ft(o),o.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${t}`);return e[i]})),decode:o=>(ft(o),o.map(i=>{Ne("alphabet.decode",i);const a=s.get(i);if(a===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${t}`);return a}))}}function Do(t=""){return Ne("join",t),{encode:e=>(ke("join.decode",e),e.join(t)),decode:e=>(Ne("join.decode",e),e.split(t))}}function Fo(t,e="="){return yt(t),Ne("padding",e),{encode(n){for(ke("padding.encode",n);n.length*t%8;)n.push(e);return n},decode(n){ke("padding.decode",n);let s=n.length;if(s*t%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;s>0&&n[s-1]===e;s--)if((s-1)*t%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,s)}}}const Fr=(t,e)=>e===0?t:Fr(e,t%e),Ee=(t,e)=>t+(e-Fr(t,e)),Fe=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function Dt(t,e,n,s){if(ft(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Ee(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${Ee(e,n)}`);let o=0,i=0;const a=Fe[e],c=Fe[n]-1,l=[];for(const d of t){if(yt(d),d>=a)throw new Error(`convertRadix2: invalid data word=${d} from=${e}`);if(o=o<<e|d,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)l.push((o>>i-n&c)>>>0);const h=Fe[i];if(h===void 0)throw new Error("invalid carry");o&=h-1}if(o=o<<n-i&c,!s&&i>=e)throw new Error("Excess padding");if(!s&&o>0)throw new Error(`Non-zero padding: ${o}`);return s&&i>0&&l.push(o>>>0),l}function Uo(t,e=!1){if(yt(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(Ee(8,t)>32||Ee(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!Bo(n))throw new Error("radix2.encode input should be Uint8Array");return Dt(Array.from(n),8,t,!e)},decode:n=>(Ro("radix2.decode",n),Uint8Array.from(Dt(n,t,8,e)))}}const Ft=Lo(Uo(5),Po("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Fo(5),Do(""));var Ho=class{name="scure";encode(t,e={}){let{padding:n=!1}=e,s=Ft.encode(t);return n?s:s.replace(/=+$/,"")}decode(t){try{let e=t.toUpperCase(),n=e.padEnd(Math.ceil(e.length/8)*8,"=");return Ft.decode(n)}catch(e){throw e instanceof Error?new Error(`Invalid Base32 string: ${e.message}`):new Error("Invalid Base32 string")}}},Ur=Object.freeze(new Ho);function Oo(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ut(t,e=""){if(!Number.isSafeInteger(t)||t<0){const n=e&&`"${e}" `;throw new Error(`${n}expected integer >= 0, got ${t}`)}}function ze(t,e,n=""){const s=Oo(t),o=t?.length,i=e!==void 0;if(!s||i&&o!==e){const a=n&&`"${n}" `,c=i?` of length ${e}`:"",l=s?`length=${o}`:`type=${typeof t}`;throw new Error(a+"expected Uint8Array"+c+", got "+l)}return t}function $o(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash must wrapped by utils.createHasher");Ut(t.outputLen),Ut(t.blockLen)}function Se(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function qo(t,e){ze(t,void 0,"digestInto() output");const n=e.outputLen;if(t.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function J(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Ue(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function F(t,e){return t<<32-e|t>>>e}function He(t,e){return t<<e|t>>>32-e>>>0}function wt(t,e={}){const n=(o,i)=>t(i).update(o).digest(),s=t(void 0);return n.outputLen=s.outputLen,n.blockLen=s.blockLen,n.create=o=>t(o),Object.assign(n,e),Object.freeze(n)}function Vo(t=32){const e=typeof globalThis=="object"?globalThis.crypto:null;if(typeof e?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return e.getRandomValues(new Uint8Array(t))}const Hr=t=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,t])});class Or{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(e,n){if($o(e),ze(n,void 0,"key"),this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(n.length>s?e.create().update(n).digest():n);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=e.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),J(o)}update(e){return Se(this),this.iHash.update(e),this}digestInto(e){Se(this),ze(e,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||=Object.create(Object.getPrototypeOf(this),{});const{oHash:n,iHash:s,finished:o,destroyed:i,blockLen:a,outputLen:c}=this;return e=e,e.finished=o,e.destroyed=i,e.blockLen=a,e.outputLen=c,e.oHash=n._cloneInto(e.oHash),e.iHash=s._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const $r=(t,e,n)=>new Or(t,e).update(n).digest();$r.create=(t,e)=>new Or(t,e);function qr(t,e,n){return t&e^~t&n}function Vr(t,e,n){return t&e^t&n^e&n}class vt{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(e,n,s,o){this.blockLen=e,this.outputLen=n,this.padOffset=s,this.isLE=o,this.buffer=new Uint8Array(e),this.view=Ue(this.buffer)}update(e){Se(this),ze(e);const{view:n,buffer:s,blockLen:o}=this,i=e.length;for(let a=0;a<i;){const c=Math.min(o-this.pos,i-a);if(c===o){const l=Ue(e);for(;o<=i-a;a+=o)this.process(l,a);continue}s.set(e.subarray(a,a+c),this.pos),this.pos+=c,a+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Se(this),qo(e,this),this.finished=!0;const{buffer:n,view:s,blockLen:o,isLE:i}=this;let{pos:a}=this;n[a++]=128,J(this.buffer.subarray(a)),this.padOffset>o-a&&(this.process(s,0),a=0);for(let u=a;u<o;u++)n[u]=0;s.setBigUint64(o-8,BigInt(this.length*8),i),this.process(s,0);const c=Ue(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const d=l/4,h=this.get();if(d>h.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<d;u++)c.setUint32(4*u,h[u],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const s=e.slice(0,n);return this.destroy(),s}_cloneInto(e){e||=new this.constructor,e.set(...this.get());const{blockLen:n,buffer:s,length:o,finished:i,destroyed:a,pos:c}=this;return e.destroyed=a,e.finished=i,e.length=o,e.pos=c,o%n&&e.buffer.set(s),e}clone(){return this._cloneInto()}}const q=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),R=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),ce=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),V=new Uint32Array(80);class Ko extends vt{A=ce[0]|0;B=ce[1]|0;C=ce[2]|0;D=ce[3]|0;E=ce[4]|0;constructor(){super(64,20,8,!1)}get(){const{A:e,B:n,C:s,D:o,E:i}=this;return[e,n,s,o,i]}set(e,n,s,o,i){this.A=e|0,this.B=n|0,this.C=s|0,this.D=o|0,this.E=i|0}process(e,n){for(let l=0;l<16;l++,n+=4)V[l]=e.getUint32(n,!1);for(let l=16;l<80;l++)V[l]=He(V[l-3]^V[l-8]^V[l-14]^V[l-16],1);let{A:s,B:o,C:i,D:a,E:c}=this;for(let l=0;l<80;l++){let d,h;l<20?(d=qr(o,i,a),h=1518500249):l<40?(d=o^i^a,h=1859775393):l<60?(d=Vr(o,i,a),h=2400959708):(d=o^i^a,h=3395469782);const u=He(s,5)+d+c+h+V[l]|0;c=a,a=i,i=He(o,30),o=s,s=u}s=s+this.A|0,o=o+this.B|0,i=i+this.C|0,a=a+this.D|0,c=c+this.E|0,this.set(s,o,i,a,c)}roundClean(){J(V)}destroy(){this.set(0,0,0,0,0),J(this.buffer)}}const Go=wt(()=>new Ko),pe=BigInt(2**32-1),Ht=BigInt(32);function Wo(t,e=!1){return e?{h:Number(t&pe),l:Number(t>>Ht&pe)}:{h:Number(t>>Ht&pe)|0,l:Number(t&pe)|0}}function Yo(t,e=!1){const n=t.length;let s=new Uint32Array(n),o=new Uint32Array(n);for(let i=0;i<n;i++){const{h:a,l:c}=Wo(t[i],e);[s[i],o[i]]=[a,c]}return[s,o]}const Ot=(t,e,n)=>t>>>n,$t=(t,e,n)=>t<<32-n|e>>>n,te=(t,e,n)=>t>>>n|e<<32-n,re=(t,e,n)=>t<<32-n|e>>>n,me=(t,e,n)=>t<<64-n|e>>>n-32,ge=(t,e,n)=>t>>>n-32|e<<64-n;function $(t,e,n,s){const o=(e>>>0)+(s>>>0);return{h:t+n+(o/2**32|0)|0,l:o|0}}const Jo=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),Xo=(t,e,n,s)=>e+n+s+(t/2**32|0)|0,Qo=(t,e,n,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(s>>>0),Zo=(t,e,n,s,o)=>e+n+s+o+(t/2**32|0)|0,ei=(t,e,n,s,o)=>(t>>>0)+(e>>>0)+(n>>>0)+(s>>>0)+(o>>>0),ti=(t,e,n,s,o,i)=>e+n+s+o+i+(t/2**32|0)|0,ri=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),K=new Uint32Array(64);class ni extends vt{constructor(e){super(64,e,8,!1)}get(){const{A:e,B:n,C:s,D:o,E:i,F:a,G:c,H:l}=this;return[e,n,s,o,i,a,c,l]}set(e,n,s,o,i,a,c,l){this.A=e|0,this.B=n|0,this.C=s|0,this.D=o|0,this.E=i|0,this.F=a|0,this.G=c|0,this.H=l|0}process(e,n){for(let u=0;u<16;u++,n+=4)K[u]=e.getUint32(n,!1);for(let u=16;u<64;u++){const m=K[u-15],g=K[u-2],w=F(m,7)^F(m,18)^m>>>3,j=F(g,17)^F(g,19)^g>>>10;K[u]=j+K[u-7]+w+K[u-16]|0}let{A:s,B:o,C:i,D:a,E:c,F:l,G:d,H:h}=this;for(let u=0;u<64;u++){const m=F(c,6)^F(c,11)^F(c,25),g=h+m+qr(c,l,d)+ri[u]+K[u]|0,j=(F(s,2)^F(s,13)^F(s,22))+Vr(s,o,i)|0;h=d,d=l,l=c,c=a+g|0,a=i,i=o,o=s,s=g+j|0}s=s+this.A|0,o=o+this.B|0,i=i+this.C|0,a=a+this.D|0,c=c+this.E|0,l=l+this.F|0,d=d+this.G|0,h=h+this.H|0,this.set(s,o,i,a,c,l,d,h)}roundClean(){J(K)}destroy(){this.set(0,0,0,0,0,0,0,0),J(this.buffer)}}class si extends ni{A=q[0]|0;B=q[1]|0;C=q[2]|0;D=q[3]|0;E=q[4]|0;F=q[5]|0;G=q[6]|0;H=q[7]|0;constructor(){super(32)}}const Kr=Yo(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),oi=Kr[0],ii=Kr[1],G=new Uint32Array(80),W=new Uint32Array(80);class ai extends vt{constructor(e){super(128,e,16,!1)}get(){const{Ah:e,Al:n,Bh:s,Bl:o,Ch:i,Cl:a,Dh:c,Dl:l,Eh:d,El:h,Fh:u,Fl:m,Gh:g,Gl:w,Hh:j,Hl:T}=this;return[e,n,s,o,i,a,c,l,d,h,u,m,g,w,j,T]}set(e,n,s,o,i,a,c,l,d,h,u,m,g,w,j,T){this.Ah=e|0,this.Al=n|0,this.Bh=s|0,this.Bl=o|0,this.Ch=i|0,this.Cl=a|0,this.Dh=c|0,this.Dl=l|0,this.Eh=d|0,this.El=h|0,this.Fh=u|0,this.Fl=m|0,this.Gh=g|0,this.Gl=w|0,this.Hh=j|0,this.Hl=T|0}process(e,n){for(let b=0;b<16;b++,n+=4)G[b]=e.getUint32(n),W[b]=e.getUint32(n+=4);for(let b=16;b<80;b++){const x=G[b-15]|0,A=W[b-15]|0,y=te(x,A,1)^te(x,A,8)^Ot(x,A,7),N=re(x,A,1)^re(x,A,8)^$t(x,A,7),f=G[b-2]|0,p=W[b-2]|0,v=te(f,p,19)^me(f,p,61)^Ot(f,p,6),k=re(f,p,19)^ge(f,p,61)^$t(f,p,6),E=Qo(N,k,W[b-7],W[b-16]),z=Zo(E,y,v,G[b-7],G[b-16]);G[b]=z|0,W[b]=E|0}let{Ah:s,Al:o,Bh:i,Bl:a,Ch:c,Cl:l,Dh:d,Dl:h,Eh:u,El:m,Fh:g,Fl:w,Gh:j,Gl:T,Hh:S,Hl:C}=this;for(let b=0;b<80;b++){const x=te(u,m,14)^te(u,m,18)^me(u,m,41),A=re(u,m,14)^re(u,m,18)^ge(u,m,41),y=u&g^~u&j,N=m&w^~m&T,f=ei(C,A,N,ii[b],W[b]),p=ti(f,S,x,y,oi[b],G[b]),v=f|0,k=te(s,o,28)^me(s,o,34)^me(s,o,39),E=re(s,o,28)^ge(s,o,34)^ge(s,o,39),z=s&i^s&c^i&c,M=o&a^o&l^a&l;S=j|0,C=T|0,j=g|0,T=w|0,g=u|0,w=m|0,{h:u,l:m}=$(d|0,h|0,p|0,v|0),d=c|0,h=l|0,c=i|0,l=a|0,i=s|0,a=o|0;const B=Jo(v,E,M);s=Xo(B,p,k,z),o=B|0}({h:s,l:o}=$(this.Ah|0,this.Al|0,s|0,o|0)),{h:i,l:a}=$(this.Bh|0,this.Bl|0,i|0,a|0),{h:c,l}=$(this.Ch|0,this.Cl|0,c|0,l|0),{h:d,l:h}=$(this.Dh|0,this.Dl|0,d|0,h|0),{h:u,l:m}=$(this.Eh|0,this.El|0,u|0,m|0),{h:g,l:w}=$(this.Fh|0,this.Fl|0,g|0,w|0),{h:j,l:T}=$(this.Gh|0,this.Gl|0,j|0,T|0),{h:S,l:C}=$(this.Hh|0,this.Hl|0,S|0,C|0),this.set(s,o,i,a,c,l,d,h,u,m,g,w,j,T,S,C)}roundClean(){J(G,W)}destroy(){J(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class ci extends ai{Ah=R[0]|0;Al=R[1]|0;Bh=R[2]|0;Bl=R[3]|0;Ch=R[4]|0;Cl=R[5]|0;Dh=R[6]|0;Dl=R[7]|0;Eh=R[8]|0;El=R[9]|0;Fh=R[10]|0;Fl=R[11]|0;Gh=R[12]|0;Gl=R[13]|0;Hh=R[14]|0;Hl=R[15]|0;constructor(){super(64)}}const li=wt(()=>new si,Hr(1)),di=wt(()=>new ci,Hr(3));var ui=class{name="noble";hmac(t,e,n){return $r(t==="sha1"?Go:t==="sha256"?li:di,e,n)}randomBytes(t){return Vo(t)}constantTimeEqual(t,e){return bo(t,e)}},Gr=Object.freeze(new ui);function hi(t){return{secret:t.secret,strategy:t.strategy??"totp",crypto:t.crypto??Gr,base32:t.base32??Ur,algorithm:t.algorithm??"sha1",digits:t.digits??6,period:t.period??30,epoch:t.epoch??Math.floor(Date.now()/1e3),t0:t.t0??0,counter:t.counter,guardrails:t.guardrails??Ae(),hooks:t.hooks}}function fi(t){return{...hi(t),token:t.token,epochTolerance:t.epochTolerance??0,counterTolerance:t.counterTolerance??0,afterTimeStep:t.afterTimeStep}}function Wr(t,e,n){if(t==="totp")return n.totp();if(t==="hotp"){if(e===void 0)throw new ht("Counter is required for HOTP strategy. Example: { strategy: 'hotp', counter: 0 }");return n.hotp(e)}throw new ht(`Unknown OTP strategy: ${t}. Valid strategies are 'totp' or 'hotp'.`)}function xi(t){let{crypto:e=Gr,base32:n=Ur,length:s=20}={};return yo({crypto:e,base32:n,length:s})}function pi(t){let{strategy:e="totp",issuer:n,label:s,secret:o,algorithm:i="sha1",digits:a=6,period:c=30,counter:l}=t;return Wr(e,l,{totp:()=>No({issuer:n,label:s,secret:o,algorithm:i,digits:a,period:c}),hotp:d=>ko({issuer:n,label:s,secret:o,algorithm:i,digits:a,counter:d})})}async function mi(t){let e=fi(t),{secret:n,token:s,crypto:o,base32:i,algorithm:a,digits:c,hooks:l}=e,d={secret:n,token:s,crypto:o,base32:i,algorithm:a,digits:c,hooks:l};return Wr(e.strategy,e.counter,{totp:()=>_o({...d,period:e.period,epoch:e.epoch,t0:e.t0,epochTolerance:e.epochTolerance,afterTimeStep:e.afterTimeStep,guardrails:e.guardrails}),hotp:h=>So({...d,counter:h,counterTolerance:e.counterTolerance,guardrails:e.guardrails})})}var ne={},Oe,qt;function gi(){return qt||(qt=1,Oe=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),Oe}var $e={},Y={},Vt;function Q(){if(Vt)return Y;Vt=1;let t;const e=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Y.getSymbolSize=function(s){if(!s)throw new Error('"version" cannot be null or undefined');if(s<1||s>40)throw new Error('"version" should be in range from 1 to 40');return s*4+17},Y.getSymbolTotalCodewords=function(s){return e[s]},Y.getBCHDigit=function(n){let s=0;for(;n!==0;)s++,n>>>=1;return s},Y.setToSJISFunction=function(s){if(typeof s!="function")throw new Error('"toSJISFunc" is not a valid function.');t=s},Y.isKanjiModeEnabled=function(){return typeof t<"u"},Y.toSJIS=function(s){return t(s)},Y}var qe={},Kt;function jt(){return Kt||(Kt=1,(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+n)}}t.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},t.from=function(s,o){if(t.isValid(s))return s;try{return e(s)}catch{return o}}})(qe)),qe}var Ve,Gt;function bi(){if(Gt)return Ve;Gt=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(e){const n=Math.floor(e/8);return(this.buffer[n]>>>7-e%8&1)===1},put:function(e,n){for(let s=0;s<n;s++)this.putBit((e>>>n-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),e&&(this.buffer[n]|=128>>>this.length%8),this.length++}},Ve=t,Ve}var Ke,Wt;function yi(){if(Wt)return Ke;Wt=1;function t(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}return t.prototype.set=function(e,n,s,o){const i=e*this.size+n;this.data[i]=s,o&&(this.reservedBit[i]=!0)},t.prototype.get=function(e,n){return this.data[e*this.size+n]},t.prototype.xor=function(e,n,s){this.data[e*this.size+n]^=s},t.prototype.isReserved=function(e,n){return this.reservedBit[e*this.size+n]},Ke=t,Ke}var Ge={},Yt;function wi(){return Yt||(Yt=1,(function(t){const e=Q().getSymbolSize;t.getRowColCoords=function(s){if(s===1)return[];const o=Math.floor(s/7)+2,i=e(s),a=i===145?26:Math.ceil((i-13)/(2*o-2))*2,c=[i-7];for(let l=1;l<o-1;l++)c[l]=c[l-1]-a;return c.push(6),c.reverse()},t.getPositions=function(s){const o=[],i=t.getRowColCoords(s),a=i.length;for(let c=0;c<a;c++)for(let l=0;l<a;l++)c===0&&l===0||c===0&&l===a-1||c===a-1&&l===0||o.push([i[c],i[l]]);return o}})(Ge)),Ge}var We={},Jt;function vi(){if(Jt)return We;Jt=1;const t=Q().getSymbolSize,e=7;return We.getPositions=function(s){const o=t(s);return[[0,0],[o-e,0],[0,o-e]]},We}var Ye={},Xt;function ji(){return Xt||(Xt=1,(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},t.from=function(o){return t.isValid(o)?parseInt(o,10):void 0},t.getPenaltyN1=function(o){const i=o.size;let a=0,c=0,l=0,d=null,h=null;for(let u=0;u<i;u++){c=l=0,d=h=null;for(let m=0;m<i;m++){let g=o.get(u,m);g===d?c++:(c>=5&&(a+=e.N1+(c-5)),d=g,c=1),g=o.get(m,u),g===h?l++:(l>=5&&(a+=e.N1+(l-5)),h=g,l=1)}c>=5&&(a+=e.N1+(c-5)),l>=5&&(a+=e.N1+(l-5))}return a},t.getPenaltyN2=function(o){const i=o.size;let a=0;for(let c=0;c<i-1;c++)for(let l=0;l<i-1;l++){const d=o.get(c,l)+o.get(c,l+1)+o.get(c+1,l)+o.get(c+1,l+1);(d===4||d===0)&&a++}return a*e.N2},t.getPenaltyN3=function(o){const i=o.size;let a=0,c=0,l=0;for(let d=0;d<i;d++){c=l=0;for(let h=0;h<i;h++)c=c<<1&2047|o.get(d,h),h>=10&&(c===1488||c===93)&&a++,l=l<<1&2047|o.get(h,d),h>=10&&(l===1488||l===93)&&a++}return a*e.N3},t.getPenaltyN4=function(o){let i=0;const a=o.data.length;for(let l=0;l<a;l++)i+=o.data[l];return Math.abs(Math.ceil(i*100/a/5)-10)*e.N4};function n(s,o,i){switch(s){case t.Patterns.PATTERN000:return(o+i)%2===0;case t.Patterns.PATTERN001:return o%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(o+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return o*i%2+o*i%3===0;case t.Patterns.PATTERN110:return(o*i%2+o*i%3)%2===0;case t.Patterns.PATTERN111:return(o*i%3+(o+i)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}t.applyMask=function(o,i){const a=i.size;for(let c=0;c<a;c++)for(let l=0;l<a;l++)i.isReserved(l,c)||i.xor(l,c,n(o,l,c))},t.getBestMask=function(o,i){const a=Object.keys(t.Patterns).length;let c=0,l=1/0;for(let d=0;d<a;d++){i(d),t.applyMask(d,o);const h=t.getPenaltyN1(o)+t.getPenaltyN2(o)+t.getPenaltyN3(o)+t.getPenaltyN4(o);t.applyMask(d,o),h<l&&(l=h,c=d)}return c}})(Ye)),Ye}var be={},Qt;function Yr(){if(Qt)return be;Qt=1;const t=jt(),e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return be.getBlocksCount=function(o,i){switch(i){case t.L:return e[(o-1)*4+0];case t.M:return e[(o-1)*4+1];case t.Q:return e[(o-1)*4+2];case t.H:return e[(o-1)*4+3];default:return}},be.getTotalCodewordsCount=function(o,i){switch(i){case t.L:return n[(o-1)*4+0];case t.M:return n[(o-1)*4+1];case t.Q:return n[(o-1)*4+2];case t.H:return n[(o-1)*4+3];default:return}},be}var Je={},le={},Zt;function Ni(){if(Zt)return le;Zt=1;const t=new Uint8Array(512),e=new Uint8Array(256);return(function(){let s=1;for(let o=0;o<255;o++)t[o]=s,e[s]=o,s<<=1,s&256&&(s^=285);for(let o=255;o<512;o++)t[o]=t[o-255]})(),le.log=function(s){if(s<1)throw new Error("log("+s+")");return e[s]},le.exp=function(s){return t[s]},le.mul=function(s,o){return s===0||o===0?0:t[e[s]+e[o]]},le}var er;function ki(){return er||(er=1,(function(t){const e=Ni();t.mul=function(s,o){const i=new Uint8Array(s.length+o.length-1);for(let a=0;a<s.length;a++)for(let c=0;c<o.length;c++)i[a+c]^=e.mul(s[a],o[c]);return i},t.mod=function(s,o){let i=new Uint8Array(s);for(;i.length-o.length>=0;){const a=i[0];for(let l=0;l<o.length;l++)i[l]^=e.mul(o[l],a);let c=0;for(;c<i.length&&i[c]===0;)c++;i=i.slice(c)}return i},t.generateECPolynomial=function(s){let o=new Uint8Array([1]);for(let i=0;i<s;i++)o=t.mul(o,new Uint8Array([1,e.exp(i)]));return o}})(Je)),Je}var Xe,tr;function Ei(){if(tr)return Xe;tr=1;const t=ki();function e(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return e.prototype.initialize=function(s){this.degree=s,this.genPoly=t.generateECPolynomial(this.degree)},e.prototype.encode=function(s){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(s.length+this.degree);o.set(s);const i=t.mod(o,this.genPoly),a=this.degree-i.length;if(a>0){const c=new Uint8Array(this.degree);return c.set(i,a),c}return i},Xe=e,Xe}var Qe={},Ze={},et={},rr;function Jr(){return rr||(rr=1,et.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}),et}var U={},nr;function Xr(){if(nr)return U;nr=1;const t="[0-9]+",e="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const s="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;U.KANJI=new RegExp(n,"g"),U.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),U.BYTE=new RegExp(s,"g"),U.NUMERIC=new RegExp(t,"g"),U.ALPHANUMERIC=new RegExp(e,"g");const o=new RegExp("^"+n+"$"),i=new RegExp("^"+t+"$"),a=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return U.testKanji=function(l){return o.test(l)},U.testNumeric=function(l){return i.test(l)},U.testAlphanumeric=function(l){return a.test(l)},U}var sr;function Z(){return sr||(sr=1,(function(t){const e=Jr(),n=Xr();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,a){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!e.isValid(a))throw new Error("Invalid version: "+a);return a>=1&&a<10?i.ccBits[0]:a<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return n.testNumeric(i)?t.NUMERIC:n.testAlphanumeric(i)?t.ALPHANUMERIC:n.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function s(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+o)}}t.from=function(i,a){if(t.isValid(i))return i;try{return s(i)}catch{return a}}})(Ze)),Ze}var or;function zi(){return or||(or=1,(function(t){const e=Q(),n=Yr(),s=jt(),o=Z(),i=Jr(),a=7973,c=e.getBCHDigit(a);function l(m,g,w){for(let j=1;j<=40;j++)if(g<=t.getCapacity(j,w,m))return j}function d(m,g){return o.getCharCountIndicator(m,g)+4}function h(m,g){let w=0;return m.forEach(function(j){const T=d(j.mode,g);w+=T+j.getBitsLength()}),w}function u(m,g){for(let w=1;w<=40;w++)if(h(m,w)<=t.getCapacity(w,g,o.MIXED))return w}t.from=function(g,w){return i.isValid(g)?parseInt(g,10):w},t.getCapacity=function(g,w,j){if(!i.isValid(g))throw new Error("Invalid QR Code version");typeof j>"u"&&(j=o.BYTE);const T=e.getSymbolTotalCodewords(g),S=n.getTotalCodewordsCount(g,w),C=(T-S)*8;if(j===o.MIXED)return C;const b=C-d(j,g);switch(j){case o.NUMERIC:return Math.floor(b/10*3);case o.ALPHANUMERIC:return Math.floor(b/11*2);case o.KANJI:return Math.floor(b/13);case o.BYTE:default:return Math.floor(b/8)}},t.getBestVersionForData=function(g,w){let j;const T=s.from(w,s.M);if(Array.isArray(g)){if(g.length>1)return u(g,T);if(g.length===0)return 1;j=g[0]}else j=g;return l(j.mode,j.getLength(),T)},t.getEncodedBits=function(g){if(!i.isValid(g)||g<7)throw new Error("Invalid QR Code version");let w=g<<12;for(;e.getBCHDigit(w)-c>=0;)w^=a<<e.getBCHDigit(w)-c;return g<<12|w}})(Qe)),Qe}var tt={},ir;function Si(){if(ir)return tt;ir=1;const t=Q(),e=1335,n=21522,s=t.getBCHDigit(e);return tt.getEncodedBits=function(i,a){const c=i.bit<<3|a;let l=c<<10;for(;t.getBCHDigit(l)-s>=0;)l^=e<<t.getBCHDigit(l)-s;return(c<<10|l)^n},tt}var rt={},nt,ar;function Ci(){if(ar)return nt;ar=1;const t=Z();function e(n){this.mode=t.NUMERIC,this.data=n.toString()}return e.getBitsLength=function(s){return 10*Math.floor(s/3)+(s%3?s%3*3+1:0)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(s){let o,i,a;for(o=0;o+3<=this.data.length;o+=3)i=this.data.substr(o,3),a=parseInt(i,10),s.put(a,10);const c=this.data.length-o;c>0&&(i=this.data.substr(o),a=parseInt(i,10),s.put(a,c*3+1))},nt=e,nt}var st,cr;function Ai(){if(cr)return st;cr=1;const t=Z(),e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(s){this.mode=t.ALPHANUMERIC,this.data=s}return n.getBitsLength=function(o){return 11*Math.floor(o/2)+6*(o%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(o){let i;for(i=0;i+2<=this.data.length;i+=2){let a=e.indexOf(this.data[i])*45;a+=e.indexOf(this.data[i+1]),o.put(a,11)}this.data.length%2&&o.put(e.indexOf(this.data[i]),6)},st=n,st}var ot,lr;function Mi(){if(lr)return ot;lr=1;const t=Z();function e(n){this.mode=t.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return e.getBitsLength=function(s){return s*8},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(n){for(let s=0,o=this.data.length;s<o;s++)n.put(this.data[s],8)},ot=e,ot}var it,dr;function Ti(){if(dr)return it;dr=1;const t=Z(),e=Q();function n(s){this.mode=t.KANJI,this.data=s}return n.getBitsLength=function(o){return o*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(s){let o;for(o=0;o<this.data.length;o++){let i=e.toSJIS(this.data[o]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[o]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),s.put(i,13)}},it=n,it}var at={exports:{}},ur;function Ii(){return ur||(ur=1,(function(t){var e={single_source_shortest_paths:function(n,s,o){var i={},a={};a[s]=0;var c=e.PriorityQueue.make();c.push(s,0);for(var l,d,h,u,m,g,w,j,T;!c.empty();){l=c.pop(),d=l.value,u=l.cost,m=n[d]||{};for(h in m)m.hasOwnProperty(h)&&(g=m[h],w=u+g,j=a[h],T=typeof a[h]>"u",(T||j>w)&&(a[h]=w,c.push(h,w),i[h]=d))}if(typeof o<"u"&&typeof a[o]>"u"){var S=["Could not find a path from ",s," to ",o,"."].join("");throw new Error(S)}return i},extract_shortest_path_from_predecessor_list:function(n,s){for(var o=[],i=s;i;)o.push(i),n[i],i=n[i];return o.reverse(),o},find_path:function(n,s,o){var i=e.single_source_shortest_paths(n,s,o);return e.extract_shortest_path_from_predecessor_list(i,o)},PriorityQueue:{make:function(n){var s=e.PriorityQueue,o={},i;n=n||{};for(i in s)s.hasOwnProperty(i)&&(o[i]=s[i]);return o.queue=[],o.sorter=n.sorter||s.default_sorter,o},default_sorter:function(n,s){return n.cost-s.cost},push:function(n,s){var o={value:n,cost:s};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(at)),at.exports}var hr;function _i(){return hr||(hr=1,(function(t){const e=Z(),n=Ci(),s=Ai(),o=Mi(),i=Ti(),a=Xr(),c=Q(),l=Ii();function d(S){return unescape(encodeURIComponent(S)).length}function h(S,C,b){const x=[];let A;for(;(A=S.exec(b))!==null;)x.push({data:A[0],index:A.index,mode:C,length:A[0].length});return x}function u(S){const C=h(a.NUMERIC,e.NUMERIC,S),b=h(a.ALPHANUMERIC,e.ALPHANUMERIC,S);let x,A;return c.isKanjiModeEnabled()?(x=h(a.BYTE,e.BYTE,S),A=h(a.KANJI,e.KANJI,S)):(x=h(a.BYTE_KANJI,e.BYTE,S),A=[]),C.concat(b,x,A).sort(function(N,f){return N.index-f.index}).map(function(N){return{data:N.data,mode:N.mode,length:N.length}})}function m(S,C){switch(C){case e.NUMERIC:return n.getBitsLength(S);case e.ALPHANUMERIC:return s.getBitsLength(S);case e.KANJI:return i.getBitsLength(S);case e.BYTE:return o.getBitsLength(S)}}function g(S){return S.reduce(function(C,b){const x=C.length-1>=0?C[C.length-1]:null;return x&&x.mode===b.mode?(C[C.length-1].data+=b.data,C):(C.push(b),C)},[])}function w(S){const C=[];for(let b=0;b<S.length;b++){const x=S[b];switch(x.mode){case e.NUMERIC:C.push([x,{data:x.data,mode:e.ALPHANUMERIC,length:x.length},{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.ALPHANUMERIC:C.push([x,{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.KANJI:C.push([x,{data:x.data,mode:e.BYTE,length:d(x.data)}]);break;case e.BYTE:C.push([{data:x.data,mode:e.BYTE,length:d(x.data)}])}}return C}function j(S,C){const b={},x={start:{}};let A=["start"];for(let y=0;y<S.length;y++){const N=S[y],f=[];for(let p=0;p<N.length;p++){const v=N[p],k=""+y+p;f.push(k),b[k]={node:v,lastCount:0},x[k]={};for(let E=0;E<A.length;E++){const z=A[E];b[z]&&b[z].node.mode===v.mode?(x[z][k]=m(b[z].lastCount+v.length,v.mode)-m(b[z].lastCount,v.mode),b[z].lastCount+=v.length):(b[z]&&(b[z].lastCount=v.length),x[z][k]=m(v.length,v.mode)+4+e.getCharCountIndicator(v.mode,C))}}A=f}for(let y=0;y<A.length;y++)x[A[y]].end=0;return{map:x,table:b}}function T(S,C){let b;const x=e.getBestModeForData(S);if(b=e.from(C,x),b!==e.BYTE&&b.bit<x.bit)throw new Error('"'+S+'" cannot be encoded with mode '+e.toString(b)+`.
 Suggested mode is: `+e.toString(x));switch(b===e.KANJI&&!c.isKanjiModeEnabled()&&(b=e.BYTE),b){case e.NUMERIC:return new n(S);case e.ALPHANUMERIC:return new s(S);case e.KANJI:return new i(S);case e.BYTE:return new o(S)}}t.fromArray=function(C){return C.reduce(function(b,x){return typeof x=="string"?b.push(T(x,null)):x.data&&b.push(T(x.data,x.mode)),b},[])},t.fromString=function(C,b){const x=u(C,c.isKanjiModeEnabled()),A=w(x),y=j(A,b),N=l.find_path(y.map,"start","end"),f=[];for(let p=1;p<N.length-1;p++)f.push(y.table[N[p]].node);return t.fromArray(g(f))},t.rawSplit=function(C){return t.fromArray(u(C,c.isKanjiModeEnabled()))}})(rt)),rt}var fr;function Bi(){if(fr)return $e;fr=1;const t=Q(),e=jt(),n=bi(),s=yi(),o=wi(),i=vi(),a=ji(),c=Yr(),l=Ei(),d=zi(),h=Si(),u=Z(),m=_i();function g(y,N){const f=y.size,p=i.getPositions(N);for(let v=0;v<p.length;v++){const k=p[v][0],E=p[v][1];for(let z=-1;z<=7;z++)if(!(k+z<=-1||f<=k+z))for(let M=-1;M<=7;M++)E+M<=-1||f<=E+M||(z>=0&&z<=6&&(M===0||M===6)||M>=0&&M<=6&&(z===0||z===6)||z>=2&&z<=4&&M>=2&&M<=4?y.set(k+z,E+M,!0,!0):y.set(k+z,E+M,!1,!0))}}function w(y){const N=y.size;for(let f=8;f<N-8;f++){const p=f%2===0;y.set(f,6,p,!0),y.set(6,f,p,!0)}}function j(y,N){const f=o.getPositions(N);for(let p=0;p<f.length;p++){const v=f[p][0],k=f[p][1];for(let E=-2;E<=2;E++)for(let z=-2;z<=2;z++)E===-2||E===2||z===-2||z===2||E===0&&z===0?y.set(v+E,k+z,!0,!0):y.set(v+E,k+z,!1,!0)}}function T(y,N){const f=y.size,p=d.getEncodedBits(N);let v,k,E;for(let z=0;z<18;z++)v=Math.floor(z/3),k=z%3+f-8-3,E=(p>>z&1)===1,y.set(v,k,E,!0),y.set(k,v,E,!0)}function S(y,N,f){const p=y.size,v=h.getEncodedBits(N,f);let k,E;for(k=0;k<15;k++)E=(v>>k&1)===1,k<6?y.set(k,8,E,!0):k<8?y.set(k+1,8,E,!0):y.set(p-15+k,8,E,!0),k<8?y.set(8,p-k-1,E,!0):k<9?y.set(8,15-k-1+1,E,!0):y.set(8,15-k-1,E,!0);y.set(p-8,8,1,!0)}function C(y,N){const f=y.size;let p=-1,v=f-1,k=7,E=0;for(let z=f-1;z>0;z-=2)for(z===6&&z--;;){for(let M=0;M<2;M++)if(!y.isReserved(v,z-M)){let B=!1;E<N.length&&(B=(N[E]>>>k&1)===1),y.set(v,z-M,B),k--,k===-1&&(E++,k=7)}if(v+=p,v<0||f<=v){v-=p,p=-p;break}}}function b(y,N,f){const p=new n;f.forEach(function(M){p.put(M.mode.bit,4),p.put(M.getLength(),u.getCharCountIndicator(M.mode,y)),M.write(p)});const v=t.getSymbolTotalCodewords(y),k=c.getTotalCodewordsCount(y,N),E=(v-k)*8;for(p.getLengthInBits()+4<=E&&p.put(0,4);p.getLengthInBits()%8!==0;)p.putBit(0);const z=(E-p.getLengthInBits())/8;for(let M=0;M<z;M++)p.put(M%2?17:236,8);return x(p,y,N)}function x(y,N,f){const p=t.getSymbolTotalCodewords(N),v=c.getTotalCodewordsCount(N,f),k=p-v,E=c.getBlocksCount(N,f),z=p%E,M=E-z,B=Math.floor(p/E),X=Math.floor(k/E),Zr=X+1,Nt=B-X,en=new l(Nt);let _e=0;const ue=new Array(E),kt=new Array(E);let Be=0;const tn=new Uint8Array(y.buffer);for(let ee=0;ee<E;ee++){const Le=ee<M?X:Zr;ue[ee]=tn.slice(_e,_e+Le),kt[ee]=en.encode(ue[ee]),_e+=Le,Be=Math.max(Be,Le)}const Re=new Uint8Array(p);let Et=0,H,O;for(H=0;H<Be;H++)for(O=0;O<E;O++)H<ue[O].length&&(Re[Et++]=ue[O][H]);for(H=0;H<Nt;H++)for(O=0;O<E;O++)Re[Et++]=kt[O][H];return Re}function A(y,N,f,p){let v;if(Array.isArray(y))v=m.fromArray(y);else if(typeof y=="string"){let B=N;if(!B){const X=m.rawSplit(y);B=d.getBestVersionForData(X,f)}v=m.fromString(y,B||40)}else throw new Error("Invalid data");const k=d.getBestVersionForData(v,f);if(!k)throw new Error("The amount of data is too big to be stored in a QR Code");if(!N)N=k;else if(N<k)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+k+`.
`);const E=b(N,f,v),z=t.getSymbolSize(N),M=new s(z);return g(M,N),w(M),j(M,N),S(M,f,0),N>=7&&T(M,N),C(M,E),isNaN(p)&&(p=a.getBestMask(M,S.bind(null,M,f))),a.applyMask(p,M),S(M,f,p),{modules:M,version:N,errorCorrectionLevel:f,maskPattern:p,segments:v}}return $e.create=function(N,f){if(typeof N>"u"||N==="")throw new Error("No input text");let p=e.M,v,k;return typeof f<"u"&&(p=e.from(f.errorCorrectionLevel,e.M),v=d.from(f.version),k=a.from(f.maskPattern),f.toSJISFunc&&t.setToSJISFunction(f.toSJISFunc)),A(N,v,p,k)},$e}var ct={},lt={},xr;function Qr(){return xr||(xr=1,(function(t){function e(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let s=n.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+n);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(i){return[i,i]}))),s.length===6&&s.push("F","F");const o=parseInt(s.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+s.slice(0,6).join("")}}t.getOptions=function(s){s||(s={}),s.color||(s.color={});const o=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,i=s.width&&s.width>=21?s.width:void 0,a=s.scale||4;return{width:i,scale:i?4:a,margin:o,color:{dark:e(s.color.dark||"#000000ff"),light:e(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},t.getScale=function(s,o){return o.width&&o.width>=s+o.margin*2?o.width/(s+o.margin*2):o.scale},t.getImageWidth=function(s,o){const i=t.getScale(s,o);return Math.floor((s+o.margin*2)*i)},t.qrToImageData=function(s,o,i){const a=o.modules.size,c=o.modules.data,l=t.getScale(a,i),d=Math.floor((a+i.margin*2)*l),h=i.margin*l,u=[i.color.light,i.color.dark];for(let m=0;m<d;m++)for(let g=0;g<d;g++){let w=(m*d+g)*4,j=i.color.light;if(m>=h&&g>=h&&m<d-h&&g<d-h){const T=Math.floor((m-h)/l),S=Math.floor((g-h)/l);j=u[c[T*a+S]?1:0]}s[w++]=j.r,s[w++]=j.g,s[w++]=j.b,s[w]=j.a}}})(lt)),lt}var pr;function Ri(){return pr||(pr=1,(function(t){const e=Qr();function n(o,i,a){o.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=a,i.width=a,i.style.height=a+"px",i.style.width=a+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,a,c){let l=c,d=a;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),a||(d=s()),l=e.getOptions(l);const h=e.getImageWidth(i.modules.size,l),u=d.getContext("2d"),m=u.createImageData(h,h);return e.qrToImageData(m.data,i,l),n(u,d,h),u.putImageData(m,0,0),d},t.renderToDataURL=function(i,a,c){let l=c;typeof l>"u"&&(!a||!a.getContext)&&(l=a,a=void 0),l||(l={});const d=t.render(i,a,l),h=l.type||"image/png",u=l.rendererOpts||{};return d.toDataURL(h,u.quality)}})(ct)),ct}var dt={},mr;function Li(){if(mr)return dt;mr=1;const t=Qr();function e(o,i){const a=o.a/255,c=i+'="'+o.hex+'"';return a<1?c+" "+i+'-opacity="'+a.toFixed(2).slice(1)+'"':c}function n(o,i,a){let c=o+i;return typeof a<"u"&&(c+=" "+a),c}function s(o,i,a){let c="",l=0,d=!1,h=0;for(let u=0;u<o.length;u++){const m=Math.floor(u%i),g=Math.floor(u/i);!m&&!d&&(d=!0),o[u]?(h++,u>0&&m>0&&o[u-1]||(c+=d?n("M",m+a,.5+g+a):n("m",l,0),l=0,d=!1),m+1<i&&o[u+1]||(c+=n("h",h),h=0)):l++}return c}return dt.render=function(i,a,c){const l=t.getOptions(a),d=i.modules.size,h=i.modules.data,u=d+l.margin*2,m=l.color.light.a?"<path "+e(l.color.light,"fill")+' d="M0 0h'+u+"v"+u+'H0z"/>':"",g="<path "+e(l.color.dark,"stroke")+' d="'+s(h,d,l.margin)+'"/>',w='viewBox="0 0 '+u+" "+u+'"',T='<svg xmlns="http://www.w3.org/2000/svg" '+(l.width?'width="'+l.width+'" height="'+l.width+'" ':"")+w+' shape-rendering="crispEdges">'+m+g+`</svg>
`;return typeof c=="function"&&c(null,T),T},dt}var gr;function Pi(){if(gr)return ne;gr=1;const t=gi(),e=Bi(),n=Ri(),s=Li();function o(i,a,c,l,d){const h=[].slice.call(arguments,1),u=h.length,m=typeof h[u-1]=="function";if(!m&&!t())throw new Error("Callback required as last argument");if(m){if(u<2)throw new Error("Too few arguments provided");u===2?(d=c,c=a,a=l=void 0):u===3&&(a.getContext&&typeof d>"u"?(d=l,l=void 0):(d=l,l=c,c=a,a=void 0))}else{if(u<1)throw new Error("Too few arguments provided");return u===1?(c=a,a=l=void 0):u===2&&!a.getContext&&(l=c,c=a,a=void 0),new Promise(function(g,w){try{const j=e.create(c,l);g(i(j,a,l))}catch(j){w(j)}})}try{const g=e.create(c,l);d(null,i(g,a,l))}catch(g){d(g)}}return ne.create=e.create,ne.toCanvas=o.bind(null,n.render),ne.toDataURL=o.bind(null,n.renderToDataURL),ne.toString=o.bind(null,function(i,a,c){return s.render(i,c)}),ne}var Di=Pi();const Fi=mn(Di);function Ui(){const[t,e]=I.useState(!1),[n,s]=I.useState(!1),[o,i]=I.useState(""),[a,c]=I.useState(""),[l,d]=I.useState(""),[h,u]=I.useState(null),[m,g]=I.useState(!1),[w,j]=I.useState(!1);I.useEffect(()=>{L.authStore.model?.mfa_enabled&&e(!0)},[]);const T=async()=>{const x=xi();i(x);const A=L.authStore.model,y=pi({secret:x,label:A?.email||"Onyx User",issuer:"Onyx",algorithm:"sha1"});try{const N=await Fi.toDataURL(y);c(N),s(!0),u(null)}catch(N){console.error(N),u("Failed to generate QR Code")}},S=async()=>{try{if(!await mi({token:l,secret:o})){u("Invalid Code");return}const A=sessionStorage.getItem("onyx_mk");if(!A){u("Session locked. Please re-login.");return}const y=await zn(o,A);await L.collection("users").update(L.authStore.model?.id,{mfa_enabled:!0,mfa_secret:JSON.stringify(y)}),e(!0),s(!1),i(""),d(""),u(null),c("")}catch(x){console.error("MFA Verify Error:",x),u(x.message||"Failed to enable MFA")}},C=async()=>{try{if(!confirm("Are you sure you want to disable Two-Factor Authentication?"))return;const x=L.authStore.model;if(!x){u("User not logged in.");return}await L.collection("users").update(x.id,{mfa_enabled:!1,mfa_secret:""}),e(!1),u(null)}catch(x){console.error("MFA Disable Error:",x),u("Failed to disable MFA.")}},b=async()=>{g(!0),u(null);try{const x=sessionStorage.getItem("onyx_mk"),A=L.authStore.model;if(!x||!A)throw new Error("Session invalid");const y=A.enc_salt,{mnemonic:N,keyWrappedRk:f,recoveryHash:p}=await Sn.rotateRecoveryKeyWithSalt(x,y);await L.collection("users").update(A.id,{key_wrapped_rk:f,recovery_hash:p}),alert(`NEW RECOVERY PHRASE:

${N}

SAVE THIS NOW. The old one is invalid.`),j(!1)}catch(x){console.error("Rotation failed",x),u("Failed to rotate key: "+x.message)}finally{g(!1)}};return r.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Security & Privacy"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Manage your encryption keys and account security."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h3",{className:"text-sm font-bold text-zinc-400 uppercase tracking-widest flex items-center gap-2",children:[r.jsx(br,{size:14})," Account Security"]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-start",children:[r.jsxs("div",{className:`relative p-6 rounded-3xl border transition-all duration-500 overflow-hidden group ${t?"bg-emerald-900/10 border-emerald-500/20 shadow-[0_0_30px_rgba(16,185,129,0.1)]":"bg-red-900/5 border-red-500/10 hover:border-red-500/20"}`,children:[t&&r.jsx("div",{className:"absolute inset-0 bg-emerald-500/5 animate-pulse"}),r.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-colors duration-500 ${t?"bg-emerald-500/20 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.2)]":"bg-red-500/10 text-red-400"}`,children:r.jsx(Zn,{size:24})}),r.jsxs("div",{children:[r.jsx("div",{className:`font-bold transition-colors duration-300 ${t?"text-emerald-100":"text-zinc-200"}`,children:"Two-Factor Auth"}),r.jsxs("div",{className:"text-xs text-zinc-500 mt-0.5 flex items-center gap-1.5",children:[r.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${t?"bg-emerald-500 animate-pulse":"bg-red-500"}`}),t?"Active & Protected":"Disabled"]})]})]}),r.jsx("button",{onClick:()=>{n?(s(!1),c(""),i(""),d("")):t?C():T()},className:`px-4 py-2 rounded-xl text-xs font-bold transition-all border ${n?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:bg-zinc-700":t?"bg-red-500/10 border-red-500/20 text-red-400 hover:bg-red-500/20":"bg-emerald-500 text-black border-emerald-400 hover:bg-emerald-400 shadow-lg shadow-emerald-500/20"}`,children:n?"Cancel":t?"Disable":"Enable 2FA"})]}),!t&&n&&a&&r.jsx("div",{className:"mt-6 pt-6 border-t border-white/5 animate-in slide-in-from-top-2 fade-in relative z-10",children:r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-start",children:[r.jsx("div",{className:"bg-white p-2 rounded-xl w-fit h-fit shrink-0 shadow-xl",children:r.jsx("img",{src:a,alt:"2FA QR Code",className:"w-32 h-32"})}),r.jsx("div",{className:"space-y-3 flex-1",children:r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-bold text-zinc-200",children:"Scan QR Code"}),r.jsx("p",{className:"text-xs text-zinc-400 mt-1",children:"Use Google Authenticator or Authy to scan this code."})]})})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500 tracking-wider",children:"Verification Code"}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[r.jsx("input",{type:"text",maxLength:6,className:"bg-black/40 border border-zinc-700 rounded-lg px-4 py-2.5 text-sm text-white focus:outline-none focus:border-emerald-500 w-full sm:w-32 font-mono tracking-widest text-center",placeholder:"000 000",value:l,onChange:x=>d(x.target.value.replace(/[^0-9]/g,""))}),r.jsx("button",{onClick:S,className:"px-6 py-2.5 bg-emerald-500 hover:bg-emerald-400 text-black rounded-lg text-xs font-bold transition-colors w-full sm:w-auto shadow-lg shadow-emerald-500/20",children:"Activate 2FA"})]}),h&&r.jsx("p",{className:"text-red-400 text-[10px] font-bold animate-in fade-in slide-in-from-top-1 bg-red-500/10 px-3 py-2 rounded-lg border border-red-500/20",children:h})]})]})})]}),r.jsxs("div",{className:"p-6 bg-zinc-900/30 border border-amber-500/20 rounded-3xl flex flex-col justify-between h-full group hover:border-amber-500/40 transition-colors relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:opacity-[0.05] transition-opacity pointer-events-none text-amber-500",children:r.jsx(Tt,{size:120})}),r.jsxs("div",{className:"flex items-center justify-between mb-4 relative z-10",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 bg-amber-500/10 rounded-2xl flex items-center justify-center text-amber-500 border border-amber-500/20 shadow-[0_0_15px_rgba(245,158,11,0.1)]",children:r.jsx(Tt,{size:24})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-zinc-100 group-hover:text-amber-200 transition-colors",children:"Emergency Kit"}),r.jsx("div",{className:"text-xs text-zinc-500 mt-0.5 group-hover:text-zinc-400",children:"Account Recovery"})]})]}),r.jsxs("button",{onClick:()=>j(!0),className:"px-3 py-1.5 bg-zinc-800 text-zinc-400 border border-white/5 rounded-lg text-[10px] font-bold hover:bg-amber-500 hover:text-black hover:border-amber-500 transition-all flex items-center gap-2",children:[r.jsx(En,{size:12,className:m?"animate-spin":""}),"Rotate"]})]}),r.jsxs("p",{className:"text-xs text-zinc-500 leading-relaxed max-w-sm mb-4 relative z-10 group-hover:text-zinc-400 transition-colors",children:["Your Emergency Kit is the ",r.jsx("strong",{children:"only"})," way to restore access if you forget your password. Onyx cannot recover it for you."]}),r.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-amber-500 uppercase tracking-wider relative z-10",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500 animate-pulse"}),r.jsx("span",{children:"Encrypted on Device"})]}),w&&r.jsx("div",{className:"absolute inset-0 z-20 bg-zinc-950/90 backdrop-blur-sm flex items-center justify-center p-6 animate-in fade-in duration-200",children:r.jsxs("div",{className:"w-full bg-zinc-900 border border-orange-500/30 rounded-2xl p-4 shadow-2xl",children:[r.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[r.jsx(gn,{className:"text-orange-500 shrink-0 mt-0.5",size:18}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-bold text-orange-500 text-sm",children:"Rotate Recovery Key?"}),r.jsx("p",{className:"text-[11px] text-zinc-400 mt-1 leading-relaxed",children:"This invalidates your old Emergency Kit immediately. You will need to save the new one."})]})]}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{onClick:()=>j(!1),className:"px-3 py-1.5 bg-zinc-800 text-zinc-300 rounded-lg text-[10px] font-bold hover:bg-zinc-700",children:"Cancel"}),r.jsx("button",{onClick:b,disabled:m,className:"px-3 py-1.5 bg-orange-500 text-black hover:bg-orange-400 rounded-lg text-[10px] font-bold",children:m?"Raotating...":"Confirm Rotation"})]})]})})]})]})]}),r.jsxs("div",{className:"space-y-4 pt-4 border-t border-white/5",children:[r.jsxs("h3",{className:"text-sm font-bold text-zinc-400 uppercase tracking-widest flex items-center gap-2",children:[r.jsx(ve,{size:14})," Security Architecture"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"group p-5 rounded-2xl bg-zinc-900/40 border border-purple-500/20 overflow-hidden relative cursor-default transition-all duration-500 hover:bg-zinc-900/60 hover:border-purple-500/40",children:[r.jsx("div",{className:"absolute inset-0 bg-purple-500/5 blur-xl group-hover:bg-purple-500/10 transition-colors"}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-purple-500/10 flex items-center justify-center text-purple-400 border border-purple-500/20 group-hover:scale-110 transition-transform duration-300 shadow-[0_0_15px_rgba(168,85,247,0.15)]",children:r.jsx(se,{size:20})}),r.jsx("span",{className:"text-[10px] font-bold text-purple-400/70 uppercase tracking-widest bg-purple-500/10 px-2 py-1 rounded-lg border border-purple-500/10",children:"Identity"})]}),r.jsx("h4",{className:"font-bold text-zinc-100 mb-1 group-hover:text-purple-300 transition-colors",children:"Client-Side Auth"}),r.jsx("p",{className:"text-[11px] text-zinc-500 leading-relaxed group-hover:text-zinc-400 transition-colors",children:"Your identity is cryptographic. Authentication happens locally, preventing server-side impersonation."})]})]}),r.jsxs("div",{className:"group p-5 rounded-2xl bg-zinc-900/40 border border-emerald-500/20 overflow-hidden relative cursor-default transition-all duration-500 hover:bg-zinc-900/60 hover:border-emerald-500/40",children:[r.jsx("div",{className:"absolute inset-0 bg-emerald-500/5 blur-xl group-hover:bg-emerald-500/10 transition-colors"}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-500/10 flex items-center justify-center text-emerald-400 border border-emerald-500/20 group-hover:scale-110 transition-transform duration-300 shadow-[0_0_15px_rgba(16,185,129,0.15)]",children:r.jsx(Mn,{size:20})}),r.jsx("span",{className:"text-[10px] font-bold text-emerald-400/70 uppercase tracking-widest bg-emerald-500/10 px-2 py-1 rounded-lg border border-emerald-500/10",children:"Hashing"})]}),r.jsx("h4",{className:"font-bold text-zinc-100 mb-1 group-hover:text-emerald-300 transition-colors",children:"Argon2id KDF"}),r.jsx("p",{className:"text-[11px] text-zinc-500 leading-relaxed group-hover:text-zinc-400 transition-colors",children:"Industry-standard memory-hard hashing protects your Master Key from brute-force attacks."})]})]}),r.jsxs("div",{className:"group p-5 rounded-2xl bg-zinc-900/40 border border-blue-500/20 overflow-hidden relative cursor-default transition-all duration-500 hover:bg-zinc-900/60 hover:border-blue-500/40",children:[r.jsx("div",{className:"absolute inset-0 bg-blue-500/5 blur-xl group-hover:bg-blue-500/10 transition-colors"}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500/10 flex items-center justify-center text-blue-400 border border-blue-500/20 group-hover:scale-110 transition-transform duration-300 shadow-[0_0_15px_rgba(59,130,246,0.15)]",children:r.jsx(ve,{size:20})}),r.jsx("span",{className:"text-[10px] font-bold text-blue-400/70 uppercase tracking-widest bg-blue-500/10 px-2 py-1 rounded-lg border border-blue-500/10",children:"Privacy"})]}),r.jsx("h4",{className:"font-bold text-zinc-100 mb-1 group-hover:text-blue-300 transition-colors",children:"Zero-Knowledge"}),r.jsx("p",{className:"text-[11px] text-zinc-500 leading-relaxed group-hover:text-zinc-400 transition-colors",children:"Even we can't see your data. Your Master Key never leaves this device unencrypted."})]})]})]})]})]})}function aa({user:t,onLogout:e}){const{isSettingsOpen:n,toggleSettings:s}=Ce(),[o,i]=I.useState("account"),[a,c]=I.useState(!1);if(!n)return null;const l=d=>{o===d&&d==="account"?c(!1):i(d)};return r.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md animate-in fade-in duration-300",onClick:()=>s(!1)}),r.jsxs("div",{className:"relative w-full max-w-5xl max-h-[90vh] h-[700px] bg-[#09090b] border border-white/5 rounded-3xl shadow-2xl flex overflow-hidden animate-in zoom-in-95 duration-200",children:[r.jsx("button",{onClick:()=>s(!1),className:"absolute top-6 right-6 z-[70] p-2 text-zinc-500 hover:text-white hover:bg-white/10 rounded-full transition-all",children:r.jsx(bn,{size:20})}),r.jsx(hs,{activeTab:o,setActiveTab:l,user:t}),r.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-black/20",children:r.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-8",children:[o==="account"&&r.jsx(zs,{user:t,onLogout:e,showAuth:a,setShowAuth:c}),o==="security"&&r.jsx(Ui,{}),o==="appearance"&&r.jsx(Ss,{}),o==="editor"&&r.jsx(Cs,{}),o==="shortcuts"&&r.jsx(Ms,{}),o==="features"&&r.jsx(Is,{}),o==="storage"&&r.jsx(_s,{}),o==="about"&&r.jsx(Ts,{})]})})]})]})}export{aa as default};
